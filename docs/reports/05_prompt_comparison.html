<!doctype html><html lang="en" class="dark"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>pytest-aitest - Test Report</title><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;600;700&amp;family=Roboto+Mono&amp;display=swap" rel="stylesheet"><script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script><style>/* ============================================================
   pytest-aitest Report Styles
   Hand-written CSS â€” replaces Tailwind CSS build pipeline
   Matches mkdocs-material slate/indigo theme
   ============================================================ */

/* ==================== Design Tokens ==================== */
:root {
  /* Primary (Material Indigo) */
  --color-primary: #4051b5;
  --color-primary-50: #e8eaf6;
  --color-primary-100: #c5cae9;
  --color-primary-200: #9fa8da;
  --color-primary-300: #7986cb;
  --color-primary-400: #5c6bc0;
  --color-primary-500: #4051b5;
  --color-primary-600: #3949ab;
  --color-primary-700: #303f9f;
  --color-primary-800: #283593;
  --color-primary-900: #1a237e;

  /* Surfaces (Slate dark) */
  --color-surface: #1e2129;
  --color-surface-card: #282c34;
  --color-surface-elevated: #2d323c;
  --color-surface-code: #1c1f26;

  /* Text */
  --color-text: #bfc7d5;
  --color-text-muted: #8b949e;
  --color-text-light: #c9d1d9;

  /* Accent */
  --color-accent: #526cfe;
  --color-accent-hover: #6b7eff;

  /* Semantic colors */
  --color-green: #4ade80;
  --color-yellow: #facc15;
  --color-red: #f87171;
  --color-blue: #60a5fa;

  /* Shadows (Material Design) */
  --shadow-material: 0 2px 4px -1px rgba(0,0,0,.2), 0 4px 5px 0 rgba(0,0,0,.14), 0 1px 10px 0 rgba(0,0,0,.12);
  --shadow-material-lg: 0 5px 5px -3px rgba(0,0,0,.2), 0 8px 10px 1px rgba(0,0,0,.14), 0 3px 14px 2px rgba(0,0,0,.12);

  /* Border radius */
  --radius-material: 4px;

  /* Fonts */
  --font-sans: 'Roboto', system-ui, sans-serif;
  --font-mono: 'Roboto Mono', monospace;
}

/* ==================== Preflight Reset ==================== */
/* Matches Tailwind CSS v3.4 preflight â€” do NOT remove or simplify */

*, *::before, *::after {
  box-sizing: border-box;
  border-width: 0;
  border-style: solid;
  border-color: rgba(255, 255, 255, 0.1);
}

::before, ::after {
  --tw-content: '';
}

html {
  line-height: 1.5;
  -webkit-text-size-adjust: 100%;
  -moz-tab-size: 4;
  tab-size: 4;
  font-family: var(--font-sans);
  font-feature-settings: normal;
  font-variation-settings: normal;
  -webkit-tap-highlight-color: transparent;
}

body {
  margin: 0;
  line-height: inherit;
}

hr {
  height: 0;
  color: inherit;
  border-top-width: 1px;
}

h1, h2, h3, h4, h5, h6 {
  font-size: inherit;
  font-weight: inherit;
}

a {
  color: inherit;
  text-decoration: inherit;
}

b, strong {
  font-weight: bolder;
}

code, kbd, samp, pre {
  font-family: var(--font-mono);
  font-feature-settings: normal;
  font-variation-settings: normal;
  font-size: 1em;
}

small {
  font-size: 80%;
}

sub, sup {
  font-size: 75%;
  line-height: 0;
  position: relative;
  vertical-align: baseline;
}
sub { bottom: -0.25em; }
sup { top: -0.5em; }

table {
  text-indent: 0;
  border-color: inherit;
  border-collapse: collapse;
}

button, input, optgroup, select, textarea {
  font-family: inherit;
  font-feature-settings: inherit;
  font-variation-settings: inherit;
  font-size: 100%;
  font-weight: inherit;
  line-height: inherit;
  letter-spacing: inherit;
  color: inherit;
  margin: 0;
  padding: 0;
}

button, select {
  text-transform: none;
}

button,
input[type="button"],
input[type="reset"],
input[type="submit"] {
  -webkit-appearance: button;
  background-color: transparent;
  background-image: none;
}

:-moz-focusring {
  outline: auto;
}

:-moz-ui-invalid {
  box-shadow: none;
}

progress {
  vertical-align: baseline;
}

::-webkit-inner-spin-button,
::-webkit-outer-spin-button {
  height: auto;
}

[type="search"] {
  -webkit-appearance: textfield;
  outline-offset: -2px;
}

::-webkit-search-decoration {
  -webkit-appearance: none;
}

::-webkit-file-upload-button {
  -webkit-appearance: button;
  font: inherit;
}

summary {
  display: list-item;
}

blockquote, dd, dl, figure, h1, h2, h3, h4, h5, h6, hr, p, pre {
  margin: 0;
}

fieldset {
  margin: 0;
  padding: 0;
}

legend {
  padding: 0;
}

ol, ul, menu {
  list-style: none;
  margin: 0;
  padding: 0;
}

dialog {
  padding: 0;
}

textarea {
  resize: vertical;
}

input::placeholder,
textarea::placeholder {
  opacity: 1;
  color: var(--color-text-muted);
}

button, [role="button"] {
  cursor: pointer;
}

:disabled {
  cursor: default;
}

img, svg, video, canvas, audio, iframe, embed, object {
  display: block;
  vertical-align: middle;
}

img, video {
  max-width: 100%;
  height: auto;
}

[hidden]:where(:not([hidden="until-found"])) {
  display: none;
}

/* ==================== Base Styles ==================== */
body {
  background-color: var(--color-surface);
  color: var(--color-text);
  font-family: var(--font-sans);
  line-height: 1.625;
  min-height: 100vh;
}

h1, h2, h3, h4, h5, h6 {
  color: var(--color-text-light);
  font-weight: 500;
  letter-spacing: -0.025em;
}

a {
  color: var(--color-primary);
  transition: color 150ms;
}
a:hover {
  color: var(--color-accent);
}

/* ==================== Layout Utilities ==================== */
.flex { display: flex; }
.grid { display: grid; }
.hidden { display: none; }
.inline-flex { display: inline-flex; }
.fixed { position: fixed; }
.absolute { position: absolute; }
.inset-0 { inset: 0; }

.flex-1 { flex: 1 1 0%; }
.flex-col { flex-direction: column; }
.flex-wrap { flex-wrap: wrap; }
.items-center { align-items: center; }
.items-start { align-items: flex-start; }
.justify-between { justify-content: space-between; }
.justify-center { justify-content: center; }
.min-w-0 { min-width: 0; }

.gap-1 { gap: 0.25rem; }
.gap-2 { gap: 0.5rem; }
.gap-3 { gap: 0.75rem; }
.gap-4 { gap: 1rem; }
.gap-x-6 { column-gap: 1.5rem; }
.gap-y-1 { row-gap: 0.25rem; }

.grid-cols-4 { grid-template-columns: repeat(4, minmax(0, 1fr)); }

/* ==================== Spacing Utilities ==================== */
.p-2 { padding: 0.5rem; }
.p-3 { padding: 0.75rem; }
.p-4 { padding: 1rem; }
.p-5 { padding: 1.25rem; }
.p-6 { padding: 1.5rem; }
.p-8 { padding: 2rem; }
.px-2 { padding-left: 0.5rem; padding-right: 0.5rem; }
.px-3 { padding-left: 0.75rem; padding-right: 0.75rem; }
.px-5 { padding-left: 1.25rem; padding-right: 1.25rem; }
.px-6 { padding-left: 1.5rem; padding-right: 1.5rem; }
.py-1 { padding-top: 0.25rem; padding-bottom: 0.25rem; }
.py-3 { padding-top: 0.75rem; padding-bottom: 0.75rem; }
.py-4 { padding-top: 1rem; padding-bottom: 1rem; }
.py-8 { padding-top: 2rem; padding-bottom: 2rem; }
.pl-4 { padding-left: 1rem; }
.pl-5 { padding-left: 1.25rem; }
.pl-8 { padding-left: 2rem; }

.mb-1 { margin-bottom: 0.25rem; }
.mb-3 { margin-bottom: 0.75rem; }
.mb-4 { margin-bottom: 1rem; }
.mb-5 { margin-bottom: 1.25rem; }
.mb-6 { margin-bottom: 1.5rem; }
.mb-8 { margin-bottom: 2rem; }
.ml-2 { margin-left: 0.5rem; }
.ml-auto { margin-left: auto; }
.mt-2 { margin-top: 0.5rem; }
.mt-6 { margin-top: 1.5rem; }
.mt-8 { margin-top: 2rem; }
.mx-auto { margin-left: auto; margin-right: auto; }
.pb-2 { padding-bottom: 0.5rem; }

.space-y-1 > * + * { margin-top: 0.25rem; }
.space-y-2 > * + * { margin-top: 0.5rem; }
.space-y-4 > * + * { margin-top: 1rem; }

/* ==================== Sizing ==================== */
.w-10 { width: 2.5rem; }
.h-10 { height: 2.5rem; }
.w-full { width: 100%; }
.h-full { height: 100%; }
.min-h-screen { min-height: 100vh; }
.max-w-none { max-width: none; }
.max-w-xl { max-width: 36rem; }
.max-w-6xl { max-width: 72rem; }
.w-\[90vw\] { width: 90vw; }
.h-\[85vh\] { height: 85vh; }

/* ==================== Typography ==================== */
.text-xs { font-size: 0.75rem; line-height: 1rem; }
.text-sm { font-size: 0.875rem; line-height: 1.25rem; }
.text-base { font-size: 1rem; line-height: 1.5rem; }
.text-lg { font-size: 1.125rem; line-height: 1.75rem; }
.text-xl { font-size: 1.25rem; line-height: 1.75rem; }
.text-2xl { font-size: 1.5rem; line-height: 2rem; }

.font-medium { font-weight: 500; }
.font-semibold { font-weight: 600; }
.font-mono { font-family: var(--font-mono); }
.tabular-nums { font-variant-numeric: tabular-nums; }
.uppercase { text-transform: uppercase; }
.italic { font-style: italic; }
.tracking-tight { letter-spacing: -0.025em; }
.tracking-wider { letter-spacing: 0.05em; }
.leading-relaxed { line-height: 1.625; }
.truncate { overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.line-through { text-decoration: line-through; }
.underline { text-decoration: underline; }
.text-left { text-align: left; }
.text-center { text-align: center; }
.text-right { text-align: right; }
.list-disc { list-style-type: disc; }

/* ==================== Text Colors ==================== */
.text-white { color: #fff; }
.text-text { color: var(--color-text); }
.text-text-light { color: var(--color-text-light); }
.text-text-muted { color: var(--color-text-muted); }
.text-primary { color: var(--color-primary); }
.text-primary-300 { color: var(--color-primary-300); }
.text-accent { color: var(--color-accent); }
.text-green-400 { color: var(--color-green); }
.text-yellow-400 { color: var(--color-yellow); }
.text-red-400 { color: var(--color-red); }
.text-blue-400 { color: var(--color-blue); }

/* ==================== Background Colors ==================== */
.bg-surface { background-color: var(--color-surface); }
.bg-surface-card { background-color: var(--color-surface-card); }
.bg-surface-elevated { background-color: var(--color-surface-elevated); }
.bg-surface-code { background-color: var(--color-surface-code); }
.bg-primary { background-color: var(--color-primary); }
.bg-primary\/10 { background-color: rgba(64, 81, 181, 0.1); }
.bg-primary\/15 { background-color: rgba(64, 81, 181, 0.15); }
.bg-primary\/20 { background-color: rgba(64, 81, 181, 0.2); }
.bg-green-500\/5 { background-color: rgba(34, 197, 94, 0.05); }
.bg-green-500\/10 { background-color: rgba(34, 197, 94, 0.1); }
.bg-green-500\/15 { background-color: rgba(34, 197, 94, 0.15); }
.bg-red-500\/5 { background-color: rgba(239, 68, 68, 0.05); }
.bg-red-500\/10 { background-color: rgba(239, 68, 68, 0.1); }
.bg-red-500\/15 { background-color: rgba(239, 68, 68, 0.15); }
.bg-yellow-500\/5 { background-color: rgba(234, 179, 8, 0.05); }
.bg-white\/5 { background-color: rgba(255, 255, 255, 0.05); }
.bg-white\/10 { background-color: rgba(255, 255, 255, 0.1); }
.bg-black\/80 { background-color: rgba(0, 0, 0, 0.8); }
.bg-transparent { background-color: transparent; }

/* ==================== Borders ==================== */
.border { border-width: 1px; }
.border-0 { border-width: 0; }
.border-t { border-top-width: 1px; }
.border-b { border-bottom-width: 1px; }
.border-l-4 { border-left-width: 4px; }
.border-l-\[3px\] { border-left-width: 3px; }

.border-white\/5 { border-color: rgba(255, 255, 255, 0.05); }
.border-white\/10 { border-color: rgba(255, 255, 255, 0.1); }
.border-white\/20 { border-color: rgba(255, 255, 255, 0.2); }
.border-primary { border-color: var(--color-primary); }
.border-primary\/30 { border-color: rgba(64, 81, 181, 0.3); }
.border-primary\/50 { border-color: rgba(64, 81, 181, 0.5); }
.border-green-500 { border-color: #22c55e; }
.border-green-500\/30 { border-color: rgba(34, 197, 94, 0.3); }
.border-red-500 { border-color: #ef4444; }
.border-red-500\/30 { border-color: rgba(239, 68, 68, 0.3); }
.border-yellow-500\/30 { border-color: rgba(234, 179, 8, 0.3); }

.rounded { border-radius: 0.25rem; }
.rounded-full { border-radius: 9999px; }
.rounded-lg { border-radius: 0.5rem; }
.rounded-material { border-radius: var(--radius-material); }

/* ==================== Effects ==================== */
.shadow-material { box-shadow: var(--shadow-material); }
.shadow-material-lg { box-shadow: var(--shadow-material-lg); }
.opacity-50 { opacity: 0.5; }
.opacity-70 { opacity: 0.7; }
.backdrop-blur-sm { backdrop-filter: blur(4px); }

.transition-colors { transition-property: color, background-color, border-color; transition-duration: 150ms; transition-timing-function: ease; }
.transition-all { transition-property: all; transition-duration: 150ms; transition-timing-function: ease; }
.transition-transform { transition-property: transform; transition-timing-function: ease; }
.duration-150 { transition-duration: 150ms; }
.duration-200 { transition-duration: 200ms; }
.ease-out { transition-timing-function: ease-out; }

/* ==================== Positioning ==================== */
.top-4 { top: 1rem; }
.right-4 { right: 1rem; }
.z-40 { z-index: 40; }
.z-50 { z-index: 50; }

/* ==================== Overflow & Cursor ==================== */
.overflow-hidden { overflow: hidden; }
.overflow-auto { overflow: auto; }
.overflow-x-auto { overflow-x: auto; }
.overflow-y-auto { overflow-y: auto; }
.cursor-pointer { cursor: pointer; }

/* ==================== Misc Utilities ==================== */
.sr-only {
  position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px;
  overflow: hidden; clip: rect(0,0,0,0); white-space: nowrap; border-width: 0;
}

/* ==================== Hover States ==================== */
.hover\:bg-white\/\[0\.02\]:hover { background-color: rgba(255, 255, 255, 0.02); }
.hover\:bg-white\/\[0\.03\]:hover { background-color: rgba(255, 255, 255, 0.03); }
.hover\:border-white\/20:hover { border-color: rgba(255, 255, 255, 0.2); }
.hover\:border-primary\/30:hover { border-color: rgba(64, 81, 181, 0.3); }
.hover\:border-primary\/50:hover { border-color: rgba(64, 81, 181, 0.5); }
.hover\:text-text-light:hover { color: var(--color-text-light); }
.hover\:text-blue-400:hover { color: var(--color-blue); }
.hover\:text-accent:hover { color: var(--color-accent); }
.hover\:decoration-accent\/50:hover { text-decoration-color: rgba(82, 108, 254, 0.5); }
.decoration-primary\/30 { text-decoration-color: rgba(64, 81, 181, 0.3); }

/* ==================== Gradient ==================== */
.bg-gradient-to-r { background-image: linear-gradient(to right, var(--tw-gradient-stops)); }
.from-purple-500\/10 { --tw-gradient-from: rgba(168, 85, 247, 0.1); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
.via-primary\/10 { --tw-gradient-stops: var(--tw-gradient-from), rgba(64, 81, 181, 0.1), var(--tw-gradient-to, transparent); }
.to-transparent { --tw-gradient-to: transparent; }

/* ============================================================
   Component Classes
   ============================================================ */

/* ==================== Report Header ==================== */
.report-header {
  background-color: var(--color-primary);
  color: #fff;
  border-radius: var(--radius-material);
  padding: 1.5rem;
  margin-bottom: 1.5rem;
  box-shadow: var(--shadow-material);
}
.report-header h1 {
  font-size: 1.5rem;
  line-height: 2rem;
  font-weight: 500;
  margin-bottom: 0.25rem;
  letter-spacing: -0.025em;
}

/* ==================== Status Badges ==================== */
.status-passed {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.25rem 0.75rem;
  border-radius: 9999px;
  background-color: rgba(34, 197, 94, 0.15);
  color: var(--color-green);
  font-weight: 500;
  font-size: 0.875rem;
  line-height: 1.25rem;
  border: 1px solid rgba(34, 197, 94, 0.3);
}
.status-failed {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.25rem 0.75rem;
  border-radius: 9999px;
  background-color: rgba(239, 68, 68, 0.15);
  color: var(--color-red);
  font-weight: 500;
  font-size: 0.875rem;
  line-height: 1.25rem;
  border: 1px solid rgba(239, 68, 68, 0.3);
}

/* ==================== Cards ==================== */
.card {
  background-color: var(--color-surface-card);
  border-radius: var(--radius-material);
  box-shadow: var(--shadow-material);
  border: 1px solid rgba(255, 255, 255, 0.05);
}
.card-header {
  padding: 1.25rem;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  font-weight: 500;
  color: var(--color-text-light);
}
.card-body {
  padding: 1.25rem;
}

/* ==================== Section Title ==================== */
.section-title {
  font-size: 1.125rem;
  line-height: 1.75rem;
  font-weight: 500;
  margin-bottom: 1.25rem;
  display: flex;
  align-items: center;
  gap: 0.75rem;
  color: var(--color-text-light);
}

/* ==================== Tool Name ==================== */
.tool-name {
  font-family: var(--font-mono);
  color: var(--color-accent);
  font-weight: 500;
}

/* ==================== AI Insights ==================== */
.ai-insights {
  background-color: var(--color-surface-card);
  border-radius: var(--radius-material);
  box-shadow: var(--shadow-material);
  border: 1px solid rgba(255, 255, 255, 0.05);
  margin-bottom: 2.5rem;
  overflow: hidden;
}
.ai-insights-header {
  padding: 1.25rem;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  font-weight: 500;
  background-image: linear-gradient(to right, rgba(168, 85, 247, 0.1), rgba(64, 81, 181, 0.1), transparent);
  display: flex;
  align-items: center;
  gap: 0.75rem;
  color: var(--color-text-light);
}

/* ==================== Leaderboard Table ==================== */
.leaderboard-table {
  width: 100%;
  font-size: 0.875rem;
  line-height: 1.25rem;
  border-collapse: collapse;
}
.leaderboard-table th {
  padding: 0.75rem 1.25rem;
  text-align: left;
  font-weight: 500;
  color: var(--color-text-muted);
  text-transform: uppercase;
  font-size: 0.75rem;
  line-height: 1rem;
  letter-spacing: 0.05em;
  background-color: var(--color-surface-elevated);
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}
.leaderboard-table td {
  padding: 1rem 1.25rem;
  border-bottom: 1px solid rgba(255, 255, 255, 0.05);
  color: var(--color-text);
}
.leaderboard-table tbody tr {
  transition: background-color 150ms;
}
.leaderboard-table tbody tr:hover {
  background-color: rgba(255, 255, 255, 0.02);
}
.winner-row {
  background-color: rgba(34, 197, 94, 0.05);
}

/* ==================== Markdown Content ==================== */
.markdown-content {
  max-width: none;
  font-size: 0.875rem;
  line-height: 1.7;
  color: var(--color-text);
}
.markdown-content h2 {
  font-size: 1.125rem;
  line-height: 1.75rem;
  font-weight: 500;
  color: var(--color-text-light);
  margin-top: 2rem;
  margin-bottom: 1rem;
  padding-bottom: 0.5rem;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}
.markdown-content h3 {
  font-size: 1rem;
  line-height: 1.5rem;
  font-weight: 500;
  color: var(--color-text-light);
  margin-top: 1.5rem;
  margin-bottom: 0.75rem;
}
.markdown-content p {
  color: var(--color-text);
  line-height: 1.625;
  margin-bottom: 1rem;
}
.markdown-content ul {
  list-style-type: disc;
  padding-left: 1.25rem;
  color: var(--color-text);
  margin-bottom: 1rem;
}
.markdown-content ul > li + li { margin-top: 0.375rem; }
.markdown-content li {
  color: var(--color-text);
}
.markdown-content li::marker {
  color: var(--color-text-muted);
}
.markdown-content code {
  background-color: var(--color-surface-code);
  padding: 0.125rem 0.375rem;
  border-radius: 0.25rem;
  color: var(--color-accent);
  font-family: var(--font-mono);
  font-size: 0.85em;
  border: 1px solid rgba(255, 255, 255, 0.05);
}
.markdown-content pre {
  background-color: var(--color-surface-code);
  border-radius: var(--radius-material);
  padding: 1rem;
  overflow-x: auto;
  border: 1px solid rgba(255, 255, 255, 0.05);
  margin-bottom: 1rem;
}
.markdown-content pre code {
  background-color: transparent;
  padding: 0;
  border: 0;
  color: var(--color-text);
  font-size: inherit;
}
.markdown-content strong {
  color: var(--color-text-light);
  font-weight: 600;
}
.markdown-content a {
  color: var(--color-primary);
  text-decoration: underline;
  text-decoration-color: rgba(64, 81, 181, 0.3);
  transition: color 150ms, text-decoration-color 150ms;
}
.markdown-content a:hover {
  color: var(--color-accent);
  text-decoration-color: rgba(82, 108, 254, 0.5);
}
.markdown-content blockquote {
  border-left: 4px solid rgba(64, 81, 181, 0.5);
  padding-left: 1rem;
  font-style: italic;
  color: var(--color-text-muted);
}
.markdown-content table {
  width: 100%;
  border-collapse: collapse;
  margin-bottom: 1rem;
}
.markdown-content th,
.markdown-content td {
  padding: 0.5rem 0.75rem;
  border: 1px solid rgba(255, 255, 255, 0.1);
  text-align: left;
}
.markdown-content th {
  background-color: var(--color-surface-elevated);
  font-weight: 500;
  color: var(--color-text-light);
}

/* ==================== Agent Selector ==================== */
.agent-chip {
  cursor: pointer;
  padding: 0.5rem 0.75rem;
  border-radius: var(--radius-material);
  border: 1px solid rgba(255, 255, 255, 0.1);
  background-color: var(--color-surface-card);
  transition: all 150ms;
}
.agent-chip:hover {
  border-color: rgba(64, 81, 181, 0.5);
}
.agent-chip.selected {
  border-color: var(--color-primary);
  background-color: rgba(64, 81, 181, 0.1);
}

/* ==================== Filter Buttons ==================== */
.filter-btn {
  padding: 0.375rem 0.75rem;
  border-radius: 0.25rem;
  font-size: 0.875rem;
  line-height: 1.25rem;
  color: var(--color-text-muted);
  border: 1px solid rgba(255, 255, 255, 0.1);
  background-color: var(--color-surface-card);
  cursor: pointer;
  transition: color 150ms, background-color 150ms, border-color 150ms;
}
.filter-btn:hover {
  border-color: rgba(255, 255, 255, 0.2);
}
.filter-btn.active {
  border-color: var(--color-primary);
  background-color: rgba(64, 81, 181, 0.2);
  color: var(--color-text-light);
}

/* ==================== Group / Expand ==================== */
.test-group.collapsed .group-content { display: none; }
.test-group.collapsed .expand-icon { transform: rotate(-90deg); }
.test-row.hidden { display: none; }
.test-detail.hidden { display: none; }

/* ==================== Overlay ==================== */
#overlay.active { display: flex !important; }
#diagram-hover-popup.active { display: block !important; }
#overlay-mermaid svg {
  max-width: 100%;
  max-height: 100%;
  width: auto;
  height: auto;
  min-height: 60vh;
}
</style></head><body class="bg-surface text-text min-h-screen"><div class="max-w-6xl mx-auto px-6 py-8"><header class="report-header mb-8"><div class="flex justify-between items-start gap-4 mb-4"><div class="flex-1"><h1 class="text-2xl font-medium mb-1">Prompt comparison â€” same model, different system prompts.</h1></div><div class="status-passed"><span>âœ“</span><span>All Passed</span></div></div><div class="flex flex-wrap gap-x-6 gap-y-1 py-3 border-t border-white/10 text-sm"><span class="opacity-70">February 07, 2026 at 07:36 PM</span><span>ğŸ“„ <span class="text-text-light hover:text-blue-400 cursor-pointer" title="tests/fixtures/scenario_05_prompt_comparison.py">scenario_05_prompt_comparison.py</span></span><span class="tabular-nums">6 tests</span><span class="tabular-nums">67.9s</span><span class="tabular-nums" title="Token range (min-max per test)">910â€“3,452 tok</span><span class="tabular-nums" title="Test execution cost">ğŸ§ª $-0.018319</span><span class="tabular-nums" title="AI analysis cost">ğŸ¤– $0.0249</span><span class="tabular-nums font-semibold" title="Total cost">ğŸ’° $0.006595</span></div></header><section class="mb-8"><div class="ai-insights"><div class="ai-insights-header"><span>ğŸ¤–</span><span>AI Analysis</span><button class="ml-auto text-text-muted hover:text-text-light text-sm" onclick="this.closest(&#39;.ai-insights&#39;).querySelector(&#39;.card-body&#39;).classList.toggle(&#39;hidden&#39;)">Toggle</button></div><div class="card-body"><div class="markdown-content"><h2>ğŸ¯ Recommendation</h2>
<p><strong>Deploy: gpt-5-mini + concise</strong></p>
<p>Achieves <strong>100% pass rate at the lowest cost</strong>, with <strong>~82% lower cost</strong> than the next closest alternative while still using tools correctly.</p>
<p><strong>Reasoning:</strong><br />
All three prompt variants passed all tests, so pass rate is tied at 100%. Cost is the decisive factor. The <strong>concise</strong> prompt consistently produced correct tool usage and compliant answers at a fraction of the cost:
- Balance query: $0.000296 vs $0.000472â€“$0.000485 (â‰ˆ40% cheaper)
- Transfer with explanation: $0.000431 vs $0.002281â€“$0.002631 (<strong>81â€“84% cheaper</strong>)</p>
<p>Response quality met test requirements without unnecessary tool calls or verbosity.</p>
<p><strong>Alternatives:</strong><br />
- <strong>structured:</strong> Same pass rate, clearer formatting, but <strong>~5Ã— higher cost</strong> on transfers. Consider only if strict response formatting is required downstream.<br />
- <strong>detailed:</strong> Same pass rate, but <strong>~6Ã— higher cost</strong> due to extra tool calls and verbose explanations. Not cost-effective for production.</p>
<h2>ğŸ”§ MCP Tool Feedback</h2>
<h3>pytest_aitest.testing.banking_mcp</h3>
<p>Overall, tools are discoverable and correctly used. The concise and structured prompts select the minimal required tools, while the detailed prompt triggers unnecessary calls.</p>
<table>
<thead>
<tr>
<th>Tool</th>
<th>Status</th>
<th>Calls</th>
<th>Issues</th>
</tr>
</thead>
<tbody>
<tr>
<td>get_balance</td>
<td>âœ…</td>
<td>3</td>
<td>Working well</td>
</tr>
<tr>
<td>get_all_balances</td>
<td>âš ï¸</td>
<td>2</td>
<td>Overused by detailed prompt for a simple transfer</td>
</tr>
<tr>
<td>transfer</td>
<td>âœ…</td>
<td>3</td>
<td>Working well</td>
</tr>
<tr>
<td>deposit</td>
<td>âœ…</td>
<td>0</td>
<td>Not exercised in tests</td>
</tr>
<tr>
<td>withdraw</td>
<td>âœ…</td>
<td>0</td>
<td>Not exercised in tests</td>
</tr>
<tr>
<td>get_transactions</td>
<td>âœ…</td>
<td>0</td>
<td>Not exercised in tests</td>
</tr>
</tbody>
</table>
<p><strong>Suggested rewrite for <code>get_all_balances</code>:</strong></p>
<blockquote>
<p>Get balances for all accounts <strong>only when a total or multi-account summary is explicitly required</strong>. For single-account checks, prefer <code>get_balance</code>.</p>
</blockquote>
<p>This clarification would discourage unnecessary pre/post calls in prompts like <strong>detailed</strong>.</p>
<h2>ğŸ“ System Prompt Feedback</h2>
<h3>concise (effective)</h3>
<ul>
<li><strong>Token count:</strong> ~25</li>
<li><strong>Assessment:</strong> Clear, minimal, and aligned with test expectations. No changes recommended.</li>
</ul>
<h3>structured (mixed)</h3>
<ul>
<li><strong>Token count:</strong> ~45</li>
<li><strong>Problem:</strong> Forces structured output even when not required, increasing token usage and response length.</li>
<li><strong>Suggested change (replace last line):</strong>
  <code>Use tools for all account operations. Never guess balances â€” always check.</code>
  âŸ¶
  <code>Use tools for all account operations. Never guess balances â€” always check. Use the format only when it adds clarity.</code></li>
</ul>
<h3>detailed (ineffective for cost)</h3>
<ul>
<li><strong>Token count:</strong> ~90+</li>
<li><strong>Problem:</strong> Mandates balance checks before and after every operation, causing redundant <code>get_all_balances</code> calls and extreme cost inflation.</li>
<li><strong>Suggested change (replace bullet list intro):</strong>
  <code>For every operation:</code>
  âŸ¶
  <code>For operations where balances change or totals are requested:</code></li>
</ul>
<h2>ğŸ’¡ Optimizations</h2>
<ol>
<li><strong>Avoid redundant balance aggregation</strong> (recommended)</li>
<li>Current: The detailed prompt triggers <code>get_all_balances</code> before and after transfers even when the transfer tool already returns new balances.</li>
<li>Change: Update the prompt to trust <code>transfer.new_balance_from</code> and <code>transfer.new_balance_to</code> unless totals are explicitly requested.</li>
<li>
<p>Impact: <strong>~80% cost reduction</strong> on transfer tests (eliminates 2 tool calls and long summaries).</p>
</li>
<li>
<p><strong>Prefer concise prompt for default agent</strong> (recommended)</p>
</li>
<li>Current: Multiple prompt variants tested equally.</li>
<li>Change: Set <strong>concise</strong> as the production default; keep others only for specialized UX needs.</li>
<li>Impact: <strong>70â€“85% lower cost per test</strong> with no loss in pass rate.</li>
</ol>
<h2>ğŸ“¦ Tool Response Optimization</h2>
<h3>transfer (from pytest_aitest.testing.banking_mcp)</h3>
<ul>
<li><strong>Current response size:</strong> ~110 tokens</li>
<li><strong>Issues found:</strong> Includes verbose fields (<code>type</code>, <code>message</code>, duplicated formatted and raw amounts) not required by the agent.</li>
<li><strong>Suggested optimization:</strong> Remove redundant fields and rely on numeric values only; let the agent format currency.</li>
</ul>
<p><strong>Example current vs optimized:</strong></p>
<pre><code class="language-json">// Current (~110 tokens)
{
  &quot;transaction_id&quot;: &quot;TX0001&quot;,
  &quot;type&quot;: &quot;transfer&quot;,
  &quot;from_account&quot;: &quot;checking&quot;,
  &quot;to_account&quot;: &quot;savings&quot;,
  &quot;amount&quot;: 300,
  &quot;amount_formatted&quot;: &quot;$300.00&quot;,
  &quot;new_balance_from&quot;: 1200.0,
  &quot;new_balance_to&quot;: 3300.0,
  &quot;message&quot;: &quot;Successfully transferred $300.00 from checking to savings.&quot;
}

// Optimized (~55 tokens)
{
  &quot;id&quot;: &quot;TX0001&quot;,
  &quot;from&quot;: &quot;checking&quot;,
  &quot;to&quot;: &quot;savings&quot;,
  &quot;amount&quot;: 300,
  &quot;balance_from&quot;: 1200.0,
  &quot;balance_to&quot;: 3300.0
}
</code></pre>
<ul>
<li><strong>Estimated savings:</strong> ~50 tokens per call (<strong>~45% reduction</strong>)</li>
</ul>
<h3>get_balance (from pytest_aitest.testing.banking_mcp)</h3>
<ul>
<li><strong>Current response size:</strong> ~40 tokens</li>
<li><strong>Issues found:</strong> Duplicate numeric and formatted values.</li>
<li><strong>Suggested optimization:</strong> Return only the numeric balance.</li>
<li><strong>Estimated savings:</strong> ~15 tokens per call (~35% reduction)</li>
</ul>
<p>These changes further amplify the cost advantage of the <strong>concise</strong> prompt without affecting correctness.</p></div></div></div></section><section class="mb-8"><h2 class="section-title">ğŸ† Agent Leaderboard</h2><div class="card overflow-hidden"><table class="leaderboard-table"><thead><tr><th class="w-10"></th><th>Agent</th><th class="text-center">Tests</th><th class="text-center">Pass Rate</th><th class="text-right">Tokens</th><th class="text-right">Cost</th><th class="text-right">Duration</th></tr></thead><tbody><tr class="winner-row"><td class="text-center text-xl">ğŸ¥‡</td><td><div class="font-medium text-text-light"><span>gpt-5-mini + concise</span></div></td><td class="text-center tabular-nums"><span class="text-green-400">2</span>/<span class="text-text-muted">2</span></td><td class="text-center"><span class="text-green-400 font-semibold tabular-nums">100%</span></td><td class="text-right tabular-nums text-text-muted">1,956</td><td class="text-right tabular-nums text-text-muted">$0.000727</td><td class="text-right tabular-nums text-text-muted">19.3s</td></tr><tr><td class="text-center text-xl">ğŸ¥ˆ</td><td><div class="font-medium text-text-light"><span>gpt-5-mini + structured</span></div></td><td class="text-center tabular-nums"><span class="text-green-400">2</span>/<span class="text-text-muted">2</span></td><td class="text-center"><span class="text-green-400 font-semibold tabular-nums">100%</span></td><td class="text-right tabular-nums text-text-muted">3,067</td><td class="text-right tabular-nums text-text-muted">$0.002753</td><td class="text-right tabular-nums text-text-muted">23.4s</td></tr><tr><td class="text-center text-xl">ğŸ¥‰</td><td><div class="font-medium text-text-light"><span>gpt-5-mini + detailed</span></div></td><td class="text-center tabular-nums"><span class="text-green-400">2</span>/<span class="text-text-muted">2</span></td><td class="text-center"><span class="text-green-400 font-semibold tabular-nums">100%</span></td><td class="text-right tabular-nums text-text-muted">4,523</td><td class="text-right tabular-nums text-text-muted">$0.003115</td><td class="text-right tabular-nums text-text-muted">25.2s</td></tr></tbody></table></div></section><section class="mb-8"><div class="card p-4"><div class="flex items-center gap-3 mb-3"><span class="text-sm text-text-muted">Compare:</span><span class="text-xs text-text-muted opacity-70">(Click to swap agents)</span></div><div class="flex flex-wrap gap-2"><label class="agent-chip selected"><input type="checkbox" name="compare-agent" value="a5486ae2-d9b1-416f-b712-55ad7244c3fa" checked="checked" class="sr-only" onchange="updateAgentComparison(&#39;a5486ae2-d9b1-416f-b712-55ad7244c3fa&#39;)"><span class="truncate">gpt-5-mini + concise</span><span class="text-xs text-text-muted tabular-nums">100%</span></label><label class="agent-chip selected"><input type="checkbox" name="compare-agent" value="59fa6919-449c-477c-a8e8-5e085d95ea33" checked="checked" class="sr-only" onchange="updateAgentComparison(&#39;59fa6919-449c-477c-a8e8-5e085d95ea33&#39;)"><span class="truncate">gpt-5-mini + structured</span><span class="text-xs text-text-muted tabular-nums">100%</span></label><label class="agent-chip "><input type="checkbox" name="compare-agent" value="5726d007-c023-4209-8381-ef8eb020e5d0" class="sr-only" onchange="updateAgentComparison(&#39;5726d007-c023-4209-8381-ef8eb020e5d0&#39;)"><span class="truncate">gpt-5-mini + detailed</span><span class="text-xs text-text-muted tabular-nums">100%</span></label></div></div></section><section class="mb-8"><h2 class="section-title">ğŸ“‹ Test Results</h2><div class="mb-4 flex items-center justify-between"><div class="flex gap-2"><button class="filter-btn active" data-filter="all" onclick="filterTests(&#39;all&#39;)">All</button><button class="filter-btn " data-filter="diff" onclick="filterTests(&#39;diff&#39;)">Differences âš¡</button><button class="filter-btn " data-filter="failed" onclick="filterTests(&#39;failed&#39;)">Failed âŒ</button></div><div class="text-sm text-text-muted"><span id="visible-count">6</span> / 6 tests</div></div><div class="space-y-4" id="test-groups"><div class="card overflow-hidden test-group" data-group-type="standalone"><div class="group-header px-5 py-3 bg-surface-elevated border-b border-white/10 flex justify-between items-center cursor-pointer" onclick="toggleGroup(this.parentElement)"><div class="flex items-center gap-3"><span class="text-lg">ğŸ“‹</span><span class="font-medium text-text-light">tests/fixtures/scenario_05_prompt_comparison.py</span><span class="text-sm text-text-muted">(2 tests)</span></div><div class="flex items-center gap-4"><div class="text-sm text-green-400">2/2</div><div class="text-sm text-green-400">2/2</div><span class="text-text-muted transition-transform duration-200 expand-icon">â–¼</span></div></div><div class="group-content"><div class="test-row border-b border-white/5" data-test-id="test_balance_check" data-has-diff="false" data-has-failed="false"><div class="px-5 py-3 hover:bg-white/[0.02] cursor-pointer transition-colors" onclick="toggleTestDetail(this.parentElement)"><div class="flex items-center justify-between"><div class="flex items-center gap-3 min-w-0 flex-1"><span class="text-green-400">âœ…</span><span class="text-text-light truncate">Balance query â€” tests how prompt style affects response formâ€¦</span></div><div class="flex items-center gap-4 text-sm text-text-muted"><span class="tabular-nums" title="Total tokens across selected agents">Total 1,957 tok</span><span class="text-text-muted">Â·</span><span class="tabular-nums" title="Total cost across selected agents">Total $0.000767</span><span class="text-text-muted">Â·</span><span class="tabular-nums" title="Token difference between selected agents (%difference)">Î” +15%</span><span class="text-text-muted">Â·</span><span class="tabular-nums" title="Duration difference between selected agents (%difference)">Î” +71%</span><span class="text-text-muted">Â·</span><span class="tabular-nums" title="Cost difference between selected agents (%difference)">Î” +60%</span></div></div><div class="flex gap-4 mt-2 pl-8"><div class="agent-result-item flex items-center gap-2 text-xs " data-agent-id="a5486ae2-d9b1-416f-b712-55ad7244c3fa"><span class="text-text-muted">gpt-5-mini + concise:</span><span class="text-green-400">âœ…</span><span class="text-text-muted tabular-nums">11.8s</span></div><div class="agent-result-item flex items-center gap-2 text-xs " data-agent-id="59fa6919-449c-477c-a8e8-5e085d95ea33"><span class="text-text-muted">gpt-5-mini + structured:</span><span class="text-green-400">âœ…</span><span class="text-text-muted tabular-nums">6.9s</span></div><div class="agent-result-item flex items-center gap-2 text-xs hidden" data-agent-id="5726d007-c023-4209-8381-ef8eb020e5d0"><span class="text-text-muted">gpt-5-mini + detailed:</span><span class="text-green-400">âœ…</span><span class="text-text-muted tabular-nums">7.7s</span></div></div></div><div class="test-detail hidden border-t border-white/10 bg-surface-elevated"><div class="comparison-grid grid gap-4 p-5" style="grid-template-columns: repeat(2, 1fr);"><div class="comparison-column  border-l-[3px] border-green-500" data-agent-id="a5486ae2-d9b1-416f-b712-55ad7244c3fa"><div class="flex items-center justify-between mb-4"><div class="font-medium text-text-light">gpt-5-mini + concise</div><span class="px-2 py-0.5 rounded text-xs font-medium bg-green-500/15 text-green-400">passed</span></div><div class="space-y-2 mb-4"><div class="grid grid-cols-4 gap-2 p-3 bg-surface-elevated rounded-material text-center"><div><div class="text-sm font-medium text-text-light tabular-nums">11.76s</div><div class="text-xs text-text-muted">duration</div></div><div><div class="text-sm font-medium text-text-light tabular-nums">3</div><div class="text-xs text-text-muted">turns</div></div><div><div class="text-sm font-medium text-text-light tabular-nums">1</div><div class="text-xs text-text-muted">tools</div></div><div><div class="text-sm font-medium text-text-light tabular-nums">910</div><div class="text-xs text-text-muted">tokens</div></div></div><div class="grid grid-cols-4 gap-2 p-3 bg-surface-elevated rounded-material text-center"><div><div class="text-sm font-medium text-text-light tabular-nums">$0.000296</div><div class="text-xs text-text-muted">cost</div></div></div></div><div class="mb-4"><div class="text-sm font-medium text-text-light mb-3 flex items-center gap-2"><span>ğŸ“Š</span><span>Sequence</span></div><div class="p-3 bg-surface-code rounded-material border border-white/5 cursor-pointer hover:border-primary/30 transition-colors" onclick="event.stopPropagation(); showDiagram(this.dataset.mermaidCode);" data-mermaid-code="sequenceDiagram
    participant User
    participant Agent
    participant Tools

    User-&gt;&gt;Agent: &#34;What&#39;s my checking account balance?&#34;
    Agent-&gt;&gt;Tools: &#34;get_balance({&#39;account&#39;: &#39;checking&#39;})&#34;
    Tools--&gt;&gt;Agent: &#34;{&#39;account&#39;: &#39;checking&#39;, &#39;balance&#39;: 1500.0, &#39;formatted&#39;: &#39;$1,&#34;
    Agent-&gt;&gt;User: &#34;Your checking balance: $1,500.00.&#34;"><div class="mermaid text-xs">sequenceDiagram
    participant User
    participant Agent
    participant Tools

    User->>Agent: "What's my checking account balance?"
    Agent->>Tools: "get_balance({'account': 'checking'})"
    Tools-->>Agent: "{'account': 'checking', 'balance': 1500.0, 'formatted': '$1,"
    Agent->>User: "Your checking balance: $1,500.00."</div></div></div><div class="mb-4"><div class="text-sm font-medium text-text-light mb-3 flex items-center gap-2"><span>ğŸ”§</span><span>Tool Calls</span></div><div class="space-y-1"><div class="flex items-center gap-2 text-sm p-2 rounded bg-green-500/5"><span class="text-green-400">âœ…</span><code class="tool-name">get_balance</code></div></div></div><div class="mb-4"><div class="text-sm font-medium text-text-light mb-3 flex items-center gap-2"><span>âœ“</span><span>Assertions</span></div><div class="space-y-2"><div class="flex items-center gap-2 text-sm p-2 rounded bg-green-500/5"><span class="text-green-400">âœ…</span><code class="text-text-muted">llm</code><span class="text-text">states the checking account balance</span></div></div></div><div class="mb-4"><div class="text-sm font-medium text-text-light mb-3 flex items-center gap-2"><span>ğŸ’¬</span><span>Response</span></div><div style="padding: 1rem; background-color: var(--color-surface-elevated); border-radius: 0.5rem; color: var(--color-text); white-space: pre-wrap; word-wrap: break-word; line-height: 1.625;">Your checking balance: $1,500.00.</div></div></div><div class="comparison-column  border-l-[3px] border-green-500" data-agent-id="59fa6919-449c-477c-a8e8-5e085d95ea33"><div class="flex items-center justify-between mb-4"><div class="font-medium text-text-light">gpt-5-mini + structured</div><span class="px-2 py-0.5 rounded text-xs font-medium bg-green-500/15 text-green-400">passed</span></div><div class="space-y-2 mb-4"><div class="grid grid-cols-4 gap-2 p-3 bg-surface-elevated rounded-material text-center"><div><div class="text-sm font-medium text-text-light tabular-nums">6.88s</div><div class="text-xs text-text-muted">duration</div></div><div><div class="text-sm font-medium text-text-light tabular-nums">3</div><div class="text-xs text-text-muted">turns</div></div><div><div class="text-sm font-medium text-text-light tabular-nums">1</div><div class="text-xs text-text-muted">tools</div></div><div><div class="text-sm font-medium text-text-light tabular-nums">1,047</div><div class="text-xs text-text-muted">tokens</div></div></div><div class="grid grid-cols-4 gap-2 p-3 bg-surface-elevated rounded-material text-center"><div><div class="text-sm font-medium text-text-light tabular-nums">$0.000472</div><div class="text-xs text-text-muted">cost</div></div></div></div><div class="mb-4"><div class="text-sm font-medium text-text-light mb-3 flex items-center gap-2"><span>ğŸ“Š</span><span>Sequence</span></div><div class="p-3 bg-surface-code rounded-material border border-white/5 cursor-pointer hover:border-primary/30 transition-colors" onclick="event.stopPropagation(); showDiagram(this.dataset.mermaidCode);" data-mermaid-code="sequenceDiagram
    participant User
    participant Agent
    participant Tools

    User-&gt;&gt;Agent: &#34;What&#39;s my checking account balance?&#34;
    Agent-&gt;&gt;Tools: &#34;get_balance({&#39;account&#39;: &#39;checking&#39;})&#34;
    Tools--&gt;&gt;Agent: &#34;{&#39;account&#39;: &#39;checking&#39;, &#39;balance&#39;: 1500.0, &#39;formatted&#39;: &#39;$1,&#34;
    Agent-&gt;&gt;User: &#34;ğŸ’° Account: checking ğŸ“Š Balance: $1,500.00 ğŸ“‹ Action: Retrieved balance âœ… Status: s&#34;"><div class="mermaid text-xs">sequenceDiagram
    participant User
    participant Agent
    participant Tools

    User->>Agent: "What's my checking account balance?"
    Agent->>Tools: "get_balance({'account': 'checking'})"
    Tools-->>Agent: "{'account': 'checking', 'balance': 1500.0, 'formatted': '$1,"
    Agent->>User: "ğŸ’° Account: checking ğŸ“Š Balance: $1,500.00 ğŸ“‹ Action: Retrieved balance âœ… Status: s"</div></div></div><div class="mb-4"><div class="text-sm font-medium text-text-light mb-3 flex items-center gap-2"><span>ğŸ”§</span><span>Tool Calls</span></div><div class="space-y-1"><div class="flex items-center gap-2 text-sm p-2 rounded bg-green-500/5"><span class="text-green-400">âœ…</span><code class="tool-name">get_balance</code></div></div></div><div class="mb-4"><div class="text-sm font-medium text-text-light mb-3 flex items-center gap-2"><span>âœ“</span><span>Assertions</span></div><div class="space-y-2"><div class="flex items-center gap-2 text-sm p-2 rounded bg-green-500/5"><span class="text-green-400">âœ…</span><code class="text-text-muted">llm</code><span class="text-text">states the checking account balance</span></div></div></div><div class="mb-4"><div class="text-sm font-medium text-text-light mb-3 flex items-center gap-2"><span>ğŸ’¬</span><span>Response</span></div><div style="padding: 1rem; background-color: var(--color-surface-elevated); border-radius: 0.5rem; color: var(--color-text); white-space: pre-wrap; word-wrap: break-word; line-height: 1.625;">ğŸ’° Account: checking
ğŸ“Š Balance: $1,500.00
ğŸ“‹ Action: Retrieved balance
âœ… Status: success</div></div></div><div class="comparison-column hidden border-l-[3px] border-green-500" data-agent-id="5726d007-c023-4209-8381-ef8eb020e5d0"><div class="flex items-center justify-between mb-4"><div class="font-medium text-text-light">gpt-5-mini + detailed</div><span class="px-2 py-0.5 rounded text-xs font-medium bg-green-500/15 text-green-400">passed</span></div><div class="space-y-2 mb-4"><div class="grid grid-cols-4 gap-2 p-3 bg-surface-elevated rounded-material text-center"><div><div class="text-sm font-medium text-text-light tabular-nums">7.73s</div><div class="text-xs text-text-muted">duration</div></div><div><div class="text-sm font-medium text-text-light tabular-nums">3</div><div class="text-xs text-text-muted">turns</div></div><div><div class="text-sm font-medium text-text-light tabular-nums">1</div><div class="text-xs text-text-muted">tools</div></div><div><div class="text-sm font-medium text-text-light tabular-nums">1,071</div><div class="text-xs text-text-muted">tokens</div></div></div><div class="grid grid-cols-4 gap-2 p-3 bg-surface-elevated rounded-material text-center"><div><div class="text-sm font-medium text-text-light tabular-nums">$0.000485</div><div class="text-xs text-text-muted">cost</div></div></div></div><div class="mb-4"><div class="text-sm font-medium text-text-light mb-3 flex items-center gap-2"><span>ğŸ“Š</span><span>Sequence</span></div><div class="p-3 bg-surface-code rounded-material border border-white/5 cursor-pointer hover:border-primary/30 transition-colors" onclick="event.stopPropagation(); showDiagram(this.dataset.mermaidCode);" data-mermaid-code="sequenceDiagram
    participant User
    participant Agent
    participant Tools

    User-&gt;&gt;Agent: &#34;What&#39;s my checking account balance?&#34;
    Agent-&gt;&gt;Tools: &#34;get_balance({&#39;account&#39;: &#39;checking&#39;})&#34;
    Tools--&gt;&gt;Agent: &#34;{&#39;account&#39;: &#39;checking&#39;, &#39;balance&#39;: 1500.0, &#39;formatted&#39;: &#39;$1,&#34;
    Agent-&gt;&gt;User: &#34;Your checking account balance is $1,500.00. Would you like to do anything with t&#34;"><div class="mermaid text-xs">sequenceDiagram
    participant User
    participant Agent
    participant Tools

    User->>Agent: "What's my checking account balance?"
    Agent->>Tools: "get_balance({'account': 'checking'})"
    Tools-->>Agent: "{'account': 'checking', 'balance': 1500.0, 'formatted': '$1,"
    Agent->>User: "Your checking account balance is $1,500.00. Would you like to do anything with t"</div></div></div><div class="mb-4"><div class="text-sm font-medium text-text-light mb-3 flex items-center gap-2"><span>ğŸ”§</span><span>Tool Calls</span></div><div class="space-y-1"><div class="flex items-center gap-2 text-sm p-2 rounded bg-green-500/5"><span class="text-green-400">âœ…</span><code class="tool-name">get_balance</code></div></div></div><div class="mb-4"><div class="text-sm font-medium text-text-light mb-3 flex items-center gap-2"><span>âœ“</span><span>Assertions</span></div><div class="space-y-2"><div class="flex items-center gap-2 text-sm p-2 rounded bg-green-500/5"><span class="text-green-400">âœ…</span><code class="text-text-muted">llm</code><span class="text-text">states the checking account balance</span></div></div></div><div class="mb-4"><div class="text-sm font-medium text-text-light mb-3 flex items-center gap-2"><span>ğŸ’¬</span><span>Response</span></div><div style="padding: 1rem; background-color: var(--color-surface-elevated); border-radius: 0.5rem; color: var(--color-text); white-space: pre-wrap; word-wrap: break-word; line-height: 1.625;">Your checking account balance is $1,500.00. Would you like to do anything with that account (transfer, withdraw, view transactions, etc.)?</div></div></div></div></div></div><div class="test-row border-b border-white/5" data-test-id="test_transfer_with_explanation" data-has-diff="false" data-has-failed="false"><div class="px-5 py-3 hover:bg-white/[0.02] cursor-pointer transition-colors" onclick="toggleTestDetail(this.parentElement)"><div class="flex items-center justify-between"><div class="flex items-center gap-3 min-w-0 flex-1"><span class="text-green-400">âœ…</span><span class="text-text-light truncate">Transfer with explanation â€” tests prompt impact on response â€¦</span></div><div class="flex items-center gap-4 text-sm text-text-muted"><span class="tabular-nums" title="Total tokens across selected agents">Total 3,066 tok</span><span class="text-text-muted">Â·</span><span class="tabular-nums" title="Total cost across selected agents">Total $0.002712</span><span class="text-text-muted">Â·</span><span class="tabular-nums" title="Token difference between selected agents (%difference)">Î” +93%</span><span class="text-text-muted">Â·</span><span class="tabular-nums" title="Duration difference between selected agents (%difference)">Î” +118%</span><span class="text-text-muted">Â·</span><span class="tabular-nums" title="Cost difference between selected agents (%difference)">Î” +429%</span></div></div><div class="flex gap-4 mt-2 pl-8"><div class="agent-result-item flex items-center gap-2 text-xs " data-agent-id="a5486ae2-d9b1-416f-b712-55ad7244c3fa"><span class="text-text-muted">gpt-5-mini + concise:</span><span class="text-green-400">âœ…</span><span class="text-text-muted tabular-nums">7.6s</span></div><div class="agent-result-item flex items-center gap-2 text-xs " data-agent-id="59fa6919-449c-477c-a8e8-5e085d95ea33"><span class="text-text-muted">gpt-5-mini + structured:</span><span class="text-green-400">âœ…</span><span class="text-text-muted tabular-nums">16.5s</span></div><div class="agent-result-item flex items-center gap-2 text-xs hidden" data-agent-id="5726d007-c023-4209-8381-ef8eb020e5d0"><span class="text-text-muted">gpt-5-mini + detailed:</span><span class="text-green-400">âœ…</span><span class="text-text-muted tabular-nums">17.5s</span></div></div></div><div class="test-detail hidden border-t border-white/10 bg-surface-elevated"><div class="comparison-grid grid gap-4 p-5" style="grid-template-columns: repeat(2, 1fr);"><div class="comparison-column  border-l-[3px] border-green-500" data-agent-id="a5486ae2-d9b1-416f-b712-55ad7244c3fa"><div class="flex items-center justify-between mb-4"><div class="font-medium text-text-light">gpt-5-mini + concise</div><span class="px-2 py-0.5 rounded text-xs font-medium bg-green-500/15 text-green-400">passed</span></div><div class="space-y-2 mb-4"><div class="grid grid-cols-4 gap-2 p-3 bg-surface-elevated rounded-material text-center"><div><div class="text-sm font-medium text-text-light tabular-nums">7.55s</div><div class="text-xs text-text-muted">duration</div></div><div><div class="text-sm font-medium text-text-light tabular-nums">3</div><div class="text-xs text-text-muted">turns</div></div><div><div class="text-sm font-medium text-text-light tabular-nums">1</div><div class="text-xs text-text-muted">tools</div></div><div><div class="text-sm font-medium text-text-light tabular-nums">1,046</div><div class="text-xs text-text-muted">tokens</div></div></div><div class="grid grid-cols-4 gap-2 p-3 bg-surface-elevated rounded-material text-center"><div><div class="text-sm font-medium text-text-light tabular-nums">$0.000431</div><div class="text-xs text-text-muted">cost</div></div></div></div><div class="mb-4"><div class="text-sm font-medium text-text-light mb-3 flex items-center gap-2"><span>ğŸ“Š</span><span>Sequence</span></div><div class="p-3 bg-surface-code rounded-material border border-white/5 cursor-pointer hover:border-primary/30 transition-colors" onclick="event.stopPropagation(); showDiagram(this.dataset.mermaidCode);" data-mermaid-code="sequenceDiagram
    participant User
    participant Agent
    participant Tools

    User-&gt;&gt;Agent: &#34;Transfer $300 from checking to savings and explain what happened&#34;
    Agent-&gt;&gt;Tools: &#34;transfer({&#39;from_account&#39;: &#39;checking&#39;, &#39;to_account&#39;: &#39;savings&#39;, &#39;amoun)&#34;
    Tools--&gt;&gt;Agent: &#34;{&#39;transaction_id&#39;: &#39;TX0001&#39;, &#39;type&#39;: &#39;transfer&#39;, &#39;from_accou&#34;
    Agent-&gt;&gt;User: &#34;Done â€” transferred $300.00 from checking to savings. Checking new balance: $1,20&#34;"><div class="mermaid text-xs">sequenceDiagram
    participant User
    participant Agent
    participant Tools

    User->>Agent: "Transfer $300 from checking to savings and explain what happened"
    Agent->>Tools: "transfer({'from_account': 'checking', 'to_account': 'savings', 'amoun)"
    Tools-->>Agent: "{'transaction_id': 'TX0001', 'type': 'transfer', 'from_accou"
    Agent->>User: "Done â€” transferred $300.00 from checking to savings. Checking new balance: $1,20"</div></div></div><div class="mb-4"><div class="text-sm font-medium text-text-light mb-3 flex items-center gap-2"><span>ğŸ”§</span><span>Tool Calls</span></div><div class="space-y-1"><div class="flex items-center gap-2 text-sm p-2 rounded bg-green-500/5"><span class="text-green-400">âœ…</span><code class="tool-name">transfer</code></div></div></div><div class="mb-4"><div class="text-sm font-medium text-text-light mb-3 flex items-center gap-2"><span>âœ“</span><span>Assertions</span></div><div class="space-y-2"><div class="flex items-center gap-2 text-sm p-2 rounded bg-green-500/5"><span class="text-green-400">âœ…</span><code class="text-text-muted">llm</code><span class="text-text">confirms the transfer was completed</span></div></div></div><div class="mb-4"><div class="text-sm font-medium text-text-light mb-3 flex items-center gap-2"><span>ğŸ’¬</span><span>Response</span></div><div style="padding: 1rem; background-color: var(--color-surface-elevated); border-radius: 0.5rem; color: var(--color-text); white-space: pre-wrap; word-wrap: break-word; line-height: 1.625;">Done â€” transferred $300.00 from checking to savings.

Checking new balance: $1,200.00
Savings new balance: $3,300.00

What happened: $300.00 was debited from your checking and credited to your savings. Transaction ID TX0001.</div></div></div><div class="comparison-column  border-l-[3px] border-green-500" data-agent-id="59fa6919-449c-477c-a8e8-5e085d95ea33"><div class="flex items-center justify-between mb-4"><div class="font-medium text-text-light">gpt-5-mini + structured</div><span class="px-2 py-0.5 rounded text-xs font-medium bg-green-500/15 text-green-400">passed</span></div><div class="space-y-2 mb-4"><div class="grid grid-cols-4 gap-2 p-3 bg-surface-elevated rounded-material text-center"><div><div class="text-sm font-medium text-text-light tabular-nums">16.48s</div><div class="text-xs text-text-muted">duration</div></div><div><div class="text-sm font-medium text-text-light tabular-nums">3</div><div class="text-xs text-text-muted">turns</div></div><div><div class="text-sm font-medium text-text-light tabular-nums">1</div><div class="text-xs text-text-muted">tools</div></div><div><div class="text-sm font-medium text-text-light tabular-nums">2,020</div><div class="text-xs text-text-muted">tokens</div></div></div><div class="grid grid-cols-4 gap-2 p-3 bg-surface-elevated rounded-material text-center"><div><div class="text-sm font-medium text-text-light tabular-nums">$0.002281</div><div class="text-xs text-text-muted">cost</div></div></div></div><div class="mb-4"><div class="text-sm font-medium text-text-light mb-3 flex items-center gap-2"><span>ğŸ“Š</span><span>Sequence</span></div><div class="p-3 bg-surface-code rounded-material border border-white/5 cursor-pointer hover:border-primary/30 transition-colors" onclick="event.stopPropagation(); showDiagram(this.dataset.mermaidCode);" data-mermaid-code="sequenceDiagram
    participant User
    participant Agent
    participant Tools

    User-&gt;&gt;Agent: &#34;Transfer $300 from checking to savings and explain what happened&#34;
    Agent-&gt;&gt;Tools: &#34;transfer({&#39;from_account&#39;: &#39;checking&#39;, &#39;to_account&#39;: &#39;savings&#39;, &#39;amoun)&#34;
    Tools--&gt;&gt;Agent: &#34;{&#39;transaction_id&#39;: &#39;TX0001&#39;, &#39;type&#39;: &#39;transfer&#39;, &#39;from_accou&#34;
    Agent-&gt;&gt;User: &#34;ğŸ’° Account: checking ğŸ“Š Balance: $1,200.00 ğŸ“‹ Action: Transferred $300.00 out to sa&#34;"><div class="mermaid text-xs">sequenceDiagram
    participant User
    participant Agent
    participant Tools

    User->>Agent: "Transfer $300 from checking to savings and explain what happened"
    Agent->>Tools: "transfer({'from_account': 'checking', 'to_account': 'savings', 'amoun)"
    Tools-->>Agent: "{'transaction_id': 'TX0001', 'type': 'transfer', 'from_accou"
    Agent->>User: "ğŸ’° Account: checking ğŸ“Š Balance: $1,200.00 ğŸ“‹ Action: Transferred $300.00 out to sa"</div></div></div><div class="mb-4"><div class="text-sm font-medium text-text-light mb-3 flex items-center gap-2"><span>ğŸ”§</span><span>Tool Calls</span></div><div class="space-y-1"><div class="flex items-center gap-2 text-sm p-2 rounded bg-green-500/5"><span class="text-green-400">âœ…</span><code class="tool-name">transfer</code></div></div></div><div class="mb-4"><div class="text-sm font-medium text-text-light mb-3 flex items-center gap-2"><span>âœ“</span><span>Assertions</span></div><div class="space-y-2"><div class="flex items-center gap-2 text-sm p-2 rounded bg-green-500/5"><span class="text-green-400">âœ…</span><code class="text-text-muted">llm</code><span class="text-text">confirms the transfer was completed</span></div></div></div><div class="mb-4"><div class="text-sm font-medium text-text-light mb-3 flex items-center gap-2"><span>ğŸ’¬</span><span>Response</span></div><div style="padding: 1rem; background-color: var(--color-surface-elevated); border-radius: 0.5rem; color: var(--color-text); white-space: pre-wrap; word-wrap: break-word; line-height: 1.625;">ğŸ’° Account: checking
ğŸ“Š Balance: $1,200.00
ğŸ“‹ Action: Transferred $300.00 out to savings (TX0001)
âœ… Status: success

ğŸ’° Account: savings
ğŸ“Š Balance: $3,300.00
ğŸ“‹ Action: Received $300.00 transfer from checking (TX0001)
âœ… Status: success

What happened: I moved $300.00 from your checking account into your savings account. The transfer debited checking and credited savings immediately, resulting in the balances shown above. Transaction ID TX0001 confirms the successful transfer. If youâ€™d like, I can show recent transactions or send a receipt.</div></div></div><div class="comparison-column hidden border-l-[3px] border-green-500" data-agent-id="5726d007-c023-4209-8381-ef8eb020e5d0"><div class="flex items-center justify-between mb-4"><div class="font-medium text-text-light">gpt-5-mini + detailed</div><span class="px-2 py-0.5 rounded text-xs font-medium bg-green-500/15 text-green-400">passed</span></div><div class="space-y-2 mb-4"><div class="grid grid-cols-4 gap-2 p-3 bg-surface-elevated rounded-material text-center"><div><div class="text-sm font-medium text-text-light tabular-nums">17.46s</div><div class="text-xs text-text-muted">duration</div></div><div><div class="text-sm font-medium text-text-light tabular-nums">5</div><div class="text-xs text-text-muted">turns</div></div><div><div class="text-sm font-medium text-text-light tabular-nums">3</div><div class="text-xs text-text-muted">tools</div></div><div><div class="text-sm font-medium text-text-light tabular-nums">3,452</div><div class="text-xs text-text-muted">tokens</div></div></div><div class="grid grid-cols-4 gap-2 p-3 bg-surface-elevated rounded-material text-center"><div><div class="text-sm font-medium text-text-light tabular-nums">$0.002631</div><div class="text-xs text-text-muted">cost</div></div></div></div><div class="mb-4"><div class="text-sm font-medium text-text-light mb-3 flex items-center gap-2"><span>ğŸ“Š</span><span>Sequence</span></div><div class="p-3 bg-surface-code rounded-material border border-white/5 cursor-pointer hover:border-primary/30 transition-colors" onclick="event.stopPropagation(); showDiagram(this.dataset.mermaidCode);" data-mermaid-code="sequenceDiagram
    participant User
    participant Agent
    participant Tools

    User-&gt;&gt;Agent: &#34;Transfer $300 from checking to savings and explain what happened&#34;
    Agent-&gt;&gt;Tools: &#34;get_all_balances({})&#34;
    Tools--&gt;&gt;Agent: &#34;{&#39;accounts&#39;: {&#39;checking&#39;: {&#39;balance&#39;: 1500.0, &#39;formatted&#39;: &#39;&#34;
    Agent-&gt;&gt;Tools: &#34;transfer({&#39;from_account&#39;: &#39;checking&#39;, &#39;to_account&#39;: &#39;savings&#39;, &#39;amoun)&#34;
    Tools--&gt;&gt;Agent: &#34;{&#39;transaction_id&#39;: &#39;TX0001&#39;, &#39;type&#39;: &#39;transfer&#39;, &#39;from_accou&#34;
    Agent-&gt;&gt;Tools: &#34;get_all_balances({})&#34;
    Tools--&gt;&gt;Agent: &#34;{&#39;accounts&#39;: {&#39;checking&#39;: {&#39;balance&#39;: 1200.0, &#39;formatted&#39;: &#39;&#34;
    Agent-&gt;&gt;User: &#34;Hereâ€™s what I did and what happened. Current balances (before the transfer) - Ch&#34;"><div class="mermaid text-xs">sequenceDiagram
    participant User
    participant Agent
    participant Tools

    User->>Agent: "Transfer $300 from checking to savings and explain what happened"
    Agent->>Tools: "get_all_balances({})"
    Tools-->>Agent: "{'accounts': {'checking': {'balance': 1500.0, 'formatted': '"
    Agent->>Tools: "transfer({'from_account': 'checking', 'to_account': 'savings', 'amoun)"
    Tools-->>Agent: "{'transaction_id': 'TX0001', 'type': 'transfer', 'from_accou"
    Agent->>Tools: "get_all_balances({})"
    Tools-->>Agent: "{'accounts': {'checking': {'balance': 1200.0, 'formatted': '"
    Agent->>User: "Hereâ€™s what I did and what happened. Current balances (before the transfer) - Ch"</div></div></div><div class="mb-4"><div class="text-sm font-medium text-text-light mb-3 flex items-center gap-2"><span>ğŸ”§</span><span>Tool Calls</span></div><div class="space-y-1"><div class="flex items-center gap-2 text-sm p-2 rounded bg-green-500/5"><span class="text-green-400">âœ…</span><code class="tool-name">get_all_balances</code></div><div class="flex items-center gap-2 text-sm p-2 rounded bg-green-500/5"><span class="text-green-400">âœ…</span><code class="tool-name">transfer</code></div><div class="flex items-center gap-2 text-sm p-2 rounded bg-green-500/5"><span class="text-green-400">âœ…</span><code class="tool-name">get_all_balances</code></div></div></div><div class="mb-4"><div class="text-sm font-medium text-text-light mb-3 flex items-center gap-2"><span>âœ“</span><span>Assertions</span></div><div class="space-y-2"><div class="flex items-center gap-2 text-sm p-2 rounded bg-green-500/5"><span class="text-green-400">âœ…</span><code class="text-text-muted">llm</code><span class="text-text">confirms the transfer was completed</span></div></div></div><div class="mb-4"><div class="text-sm font-medium text-text-light mb-3 flex items-center gap-2"><span>ğŸ’¬</span><span>Response</span></div><div style="padding: 1rem; background-color: var(--color-surface-elevated); border-radius: 0.5rem; color: var(--color-text); white-space: pre-wrap; word-wrap: break-word; line-height: 1.625;">Hereâ€™s what I did and what happened.

Current balances (before the transfer)
- Checking: $1,500.00
- Savings: $3,000.00
- Total across accounts: $4,500.00

Requested action
- Transfer $300.00 from checking to savings.

Transfer details and result
- Amount transferred: $300.00
- From account: checking
- To account: savings
- Transaction ID: TX0001
- Status: Successful

Balances after the transfer
- Checking: $1,200.00 (was $1,500.00)
- Savings: $3,300.00 (was $3,000.00)
- Total across accounts: $4,500.00 (unchanged)

Fees and implications
- No transfer fees applied for this internal transfer between your checking and savings.
- This is an internal transfer and does not affect your total cash holdingsâ€”only the distribution between accounts changed.
- If your savings account earns interest, the moved funds will begin accruing interest according to your savings rate and any compounding schedule your bank uses.
- If you have minimum-balance requirements on either account, confirm that the new balances still meet those requirements to avoid potential monthly fees or restrictions.

Summary
- I moved $300.00 from checking to savings. Checking decreased by $300.00 to $1,200.00; savings increased by $300.00 to $3,300.00. No fees were charged.

Suggested next steps
- If this transfer was to build an emergency fund, consider setting up an automatic recurring transfer (e.g., weekly or monthly).
- If you need help checking whether either account has minimum-balance rules or would like to set up a recurring transfer, I can do that for you.
- If you want to withdraw or transfer more money, tell me the amount and target account and Iâ€™ll perform and verify it.

Would you like me to set up a recurring transfer, check account rules/fees, or do anything else now?</div></div></div></div></div></div></div></div></div><style>
.test-group.collapsed .group-content {
    display: none;
}
.test-group.collapsed .expand-icon {
    transform: rotate(-90deg);
}
.test-row.hidden {
    display: none;
}
.test-detail.hidden {
    display: none;
}
</style></section></div><div id="overlay" class="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 hidden items-center justify-center p-8" onclick="hideOverlay()"><button class="absolute top-4 right-4 w-10 h-10 flex items-center justify-center text-2xl text-text-muted hover:text-text-light bg-surface-card rounded-full border border-white/10 transition-colors" onclick="hideOverlay()">âœ•</button><div class="w-[90vw] h-[85vh] overflow-auto bg-surface-card rounded-lg p-6 shadow-material-lg flex items-center justify-center" onclick="event.stopPropagation()"><div class="mermaid w-full h-full" id="overlay-mermaid"></div></div></div><div id="diagram-hover-popup" class="fixed z-40 bg-surface-card rounded-lg shadow-material-lg border border-white/10 p-4 hidden max-w-xl" onmouseenter="keepDiagramHover()" onmouseleave="hideDiagramHover()" onclick="hideOverlay(); this.classList.add(&#39;hidden&#39;); showDiagram(document.getElementById(&#39;hover-mermaid&#39;).innerHTML);"><div class="mermaid" id="hover-mermaid"></div></div><style>
#overlay.active { display: flex !important; }
#diagram-hover-popup.active { display: block !important; }

/* Scale the mermaid SVG in overlay to fill available space */
#overlay-mermaid svg {
    max-width: 100%;
    max-height: 100%;
    width: auto;
    height: auto;
    min-height: 60vh;
}
</style><script>
// pytest-aitest Report Scripts

// Initialize Mermaid with dark theme
mermaid.initialize({ 
    startOnLoad: true,
    theme: 'dark',
    securityLevel: 'loose',
    themeVariables: {
        primaryColor: '#4051b5',
        primaryTextColor: '#c9d1d9',
        primaryBorderColor: '#4051b5',
        lineColor: '#8b949e',
        secondaryColor: '#282c34',
        tertiaryColor: '#1e2129',
        background: '#282c34',
        mainBkg: '#282c34',
        noteBkgColor: '#2d333b',
        noteTextColor: '#c9d1d9',
        actorTextColor: '#c9d1d9',
        actorBkg: '#2d323c',
        actorBorder: '#4051b5',
        signalColor: '#c9d1d9',
        signalTextColor: '#c9d1d9',
    }
});

// Copy to clipboard for suggestions
function copyToClipboard(button, text) {
    navigator.clipboard.writeText(text).then(() => {
        const originalText = button.textContent;
        button.textContent = 'âœ“ Copied!';
        button.classList.add('copied');
        setTimeout(() => {
            button.textContent = originalText;
            button.classList.remove('copied');
        }, 2000);
    }).catch(err => {
        console.error('Failed to copy:', err);
        button.textContent = 'âŒ Error';
        setTimeout(() => {
            button.textContent = 'ğŸ“‹ Copy';
        }, 2000);
    });
}

// Fullscreen diagram viewer
function showDiagram(mermaidCode) {
    const overlay = document.getElementById('overlay');
    const content = document.getElementById('overlay-mermaid');
    
    // Set the raw mermaid code as text content (not innerHTML to avoid escaping issues)
    content.textContent = mermaidCode;
    
    // Remove any previous rendering attributes
    content.removeAttribute('data-processed');
    
    overlay.classList.add('active');
    
    // Run mermaid on this element
    mermaid.run({ nodes: [content] }).catch(err => {
        console.error('Mermaid render error:', err);
        // Show the raw code if rendering fails
        content.textContent = 'Error rendering diagram:\n' + mermaidCode;
    });
}

function hideOverlay() {
    document.getElementById('overlay').classList.remove('active');
}

// Close overlay on Escape key
document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') hideOverlay();
});

// Hover popup for side-by-side diagrams
let hoverTimeout = null;
function showDiagramHover(element, mermaidCode) {
    clearTimeout(hoverTimeout);
    const popup = document.getElementById('diagram-hover-popup');
    const content = document.getElementById('hover-mermaid');
    content.innerHTML = mermaidCode;
    popup.classList.add('active');
    mermaid.run({ nodes: [content] });
}

function hideDiagramHover() {
    hoverTimeout = setTimeout(() => {
        document.getElementById('diagram-hover-popup').classList.remove('active');
    }, 100);
}

function keepDiagramHover() {
    clearTimeout(hoverTimeout);
}

// Side-by-side test selector
function showSideBySideTest(testId) {
    // Hide all groups
    document.querySelectorAll('.side-by-side-group').forEach(group => {
        group.classList.remove('active');
    });
    // Show selected group
    const selected = document.getElementById(testId);
    if (selected) {
        selected.classList.add('active');
        // Re-render mermaid diagrams in the newly visible group
        mermaid.run({ nodes: selected.querySelectorAll('.mermaid') });
    }
}


// All agent data for client-side filtering
const allAgents = [{"id": "a5486ae2-d9b1-416f-b712-55ad7244c3fa", "name": "gpt-5-mini + concise", "pass_rate": 100.0}, {"id": "59fa6919-449c-477c-a8e8-5e085d95ea33", "name": "gpt-5-mini + structured", "pass_rate": 100.0}, {"id": "5726d007-c023-4209-8381-ef8eb020e5d0", "name": "gpt-5-mini + detailed", "pass_rate": 100.0}];
const allAgentsById = {"a5486ae2-d9b1-416f-b712-55ad7244c3fa": {"id": "a5486ae2-d9b1-416f-b712-55ad7244c3fa", "name": "gpt-5-mini + concise"}, "59fa6919-449c-477c-a8e8-5e085d95ea33": {"id": "59fa6919-449c-477c-a8e8-5e085d95ea33", "name": "gpt-5-mini + structured"}, "5726d007-c023-4209-8381-ef8eb020e5d0": {"id": "5726d007-c023-4209-8381-ef8eb020e5d0", "name": "gpt-5-mini + detailed"}};

// Track selected agents (exactly 2)
let selectedAgentIds = ["a5486ae2-d9b1-416f-b712-55ad7244c3fa", "59fa6919-449c-477c-a8e8-5e085d95ea33"];

// Agent comparison logic - always keep exactly 2 selected
function updateAgentComparison(clickedAgentId) {
    const checkboxes = document.querySelectorAll('input[name="compare-agent"]');
    
    // If clicking an already-selected agent, do nothing (keep 2 selected)
    if (selectedAgentIds.includes(clickedAgentId)) {
        // Re-check it to prevent unchecking
        checkboxes.forEach(cb => {
            if (cb.value === clickedAgentId) {
                cb.checked = true;
            }
        });
        return;
    }
    
    // Replace the oldest selection with the new one
    selectedAgentIds.shift();  // Remove first (oldest)
    selectedAgentIds.push(clickedAgentId);  // Add new one
    
    // Update all checkboxes to match selectedAgentIds
    checkboxes.forEach(cb => {
        cb.checked = selectedAgentIds.includes(cb.value);
        cb.closest('.agent-chip').classList.toggle('selected', cb.checked);
    });
    
    // Update visible columns in test comparison
    document.querySelectorAll('.comparison-column').forEach(col => {
        const agentId = col.dataset.agentId;
        if (agentId) {
            const shouldShow = selectedAgentIds.includes(agentId);
            col.classList.toggle('hidden', !shouldShow);
            
            // Render mermaid diagrams in newly visible columns
            if (shouldShow) {
                const diagrams = col.querySelectorAll('.mermaid:not([data-processed])');
                if (diagrams.length > 0) {
                    mermaid.run({ nodes: diagrams });
                }
            }
        }
    });
    
    // Update comparison grid layout based on visible columns
    document.querySelectorAll('.comparison-grid').forEach(grid => {
        const visibleCols = grid.querySelectorAll('.comparison-column:not(.hidden)').length;
        grid.style.gridTemplateColumns = `repeat(${visibleCols}, 1fr)`;
    });
    
    // Update agent cards visibility
    document.querySelectorAll('.agent-card[data-card-id]').forEach(card => {
        const agentId = card.dataset.cardId;
        card.classList.toggle('hidden', !selectedAgentIds.includes(agentId));
    });
    
    // Update comparison row agent results
    document.querySelectorAll('.agent-result-item').forEach(item => {
        const agentId = item.dataset.agentId;
        item.classList.toggle('hidden', !selectedAgentIds.includes(agentId));
    });
    
    console.log('Selected agents:', selectedAgentIds);
}

// Test filtering
function filterTests(filter) {
    document.querySelectorAll('.filter-btn').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.filter === filter);
    });
    
    let visibleCount = 0;
    document.querySelectorAll('.test-row').forEach(row => {
        let show = true;
        if (filter === 'diff') {
            show = row.dataset.hasDiff === 'true';
        } else if (filter === 'failed') {
            show = row.dataset.hasFailed === 'true';
        }
        row.classList.toggle('hidden', !show);
        if (show) visibleCount++;
    });
    
    document.getElementById('visible-count').textContent = visibleCount;
}

// Group toggle
function toggleGroup(group) {
    group.classList.toggle('collapsed');
}

// Test detail toggle - also renders mermaid diagrams when expanded
function toggleTestDetail(row) {
    const detail = row.querySelector('.test-detail');
    const wasHidden = detail.classList.contains('hidden');
    detail.classList.toggle('hidden');
    
    // If we're showing the detail, render any mermaid diagrams
    if (wasHidden) {
        const diagrams = detail.querySelectorAll('.mermaid:not([data-processed])');
        if (diagrams.length > 0) {
            mermaid.run({ nodes: diagrams });
        }
    }
}

// Initialize on page load - process visible mermaid diagrams
document.addEventListener('DOMContentLoaded', () => {
    // Mermaid should auto-process with startOnLoad, but just in case
    const visibleDiagrams = document.querySelectorAll('.mermaid:not(.hidden .mermaid)');
    if (visibleDiagrams.length > 0) {
        mermaid.run({ nodes: visibleDiagrams });
    }
});
</script></body></html>