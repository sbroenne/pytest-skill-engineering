<!doctype html><html lang="en" class="dark"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>pytest-aitest - Test Report</title><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;600;700&amp;family=Roboto+Mono&amp;display=swap" rel="stylesheet"><script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script><style>/* ============================================================
   pytest-aitest Report Styles
   Hand-written CSS â€” replaces Tailwind CSS build pipeline
   Matches mkdocs-material slate/indigo theme
   ============================================================ */

/* ==================== Design Tokens ==================== */
:root {
  /* Primary (Material Indigo) */
  --color-primary: #4051b5;
  --color-primary-50: #e8eaf6;
  --color-primary-100: #c5cae9;
  --color-primary-200: #9fa8da;
  --color-primary-300: #7986cb;
  --color-primary-400: #5c6bc0;
  --color-primary-500: #4051b5;
  --color-primary-600: #3949ab;
  --color-primary-700: #303f9f;
  --color-primary-800: #283593;
  --color-primary-900: #1a237e;

  /* Surfaces (Slate dark) */
  --color-surface: #1e2129;
  --color-surface-card: #282c34;
  --color-surface-elevated: #2d323c;
  --color-surface-code: #1c1f26;

  /* Text */
  --color-text: #bfc7d5;
  --color-text-muted: #8b949e;
  --color-text-light: #c9d1d9;

  /* Accent */
  --color-accent: #526cfe;
  --color-accent-hover: #6b7eff;

  /* Semantic colors */
  --color-green: #4ade80;
  --color-yellow: #facc15;
  --color-red: #f87171;
  --color-blue: #60a5fa;

  /* Shadows (Material Design) */
  --shadow-material: 0 2px 4px -1px rgba(0,0,0,.2), 0 4px 5px 0 rgba(0,0,0,.14), 0 1px 10px 0 rgba(0,0,0,.12);
  --shadow-material-lg: 0 5px 5px -3px rgba(0,0,0,.2), 0 8px 10px 1px rgba(0,0,0,.14), 0 3px 14px 2px rgba(0,0,0,.12);

  /* Border radius */
  --radius-material: 4px;

  /* Fonts */
  --font-sans: 'Roboto', system-ui, sans-serif;
  --font-mono: 'Roboto Mono', monospace;
}

/* ==================== Preflight Reset ==================== */
/* Matches Tailwind CSS v3.4 preflight â€” do NOT remove or simplify */

*, *::before, *::after {
  box-sizing: border-box;
  border-width: 0;
  border-style: solid;
  border-color: rgba(255, 255, 255, 0.1);
}

::before, ::after {
  --tw-content: '';
}

html {
  line-height: 1.5;
  -webkit-text-size-adjust: 100%;
  -moz-tab-size: 4;
  tab-size: 4;
  font-family: var(--font-sans);
  font-feature-settings: normal;
  font-variation-settings: normal;
  -webkit-tap-highlight-color: transparent;
}

body {
  margin: 0;
  line-height: inherit;
}

hr {
  height: 0;
  color: inherit;
  border-top-width: 1px;
}

h1, h2, h3, h4, h5, h6 {
  font-size: inherit;
  font-weight: inherit;
}

a {
  color: inherit;
  text-decoration: inherit;
}

b, strong {
  font-weight: bolder;
}

code, kbd, samp, pre {
  font-family: var(--font-mono);
  font-feature-settings: normal;
  font-variation-settings: normal;
  font-size: 1em;
}

small {
  font-size: 80%;
}

sub, sup {
  font-size: 75%;
  line-height: 0;
  position: relative;
  vertical-align: baseline;
}
sub { bottom: -0.25em; }
sup { top: -0.5em; }

table {
  text-indent: 0;
  border-color: inherit;
  border-collapse: collapse;
}

button, input, optgroup, select, textarea {
  font-family: inherit;
  font-feature-settings: inherit;
  font-variation-settings: inherit;
  font-size: 100%;
  font-weight: inherit;
  line-height: inherit;
  letter-spacing: inherit;
  color: inherit;
  margin: 0;
  padding: 0;
}

button, select {
  text-transform: none;
}

button,
input[type="button"],
input[type="reset"],
input[type="submit"] {
  -webkit-appearance: button;
  background-color: transparent;
  background-image: none;
}

:-moz-focusring {
  outline: auto;
}

:-moz-ui-invalid {
  box-shadow: none;
}

progress {
  vertical-align: baseline;
}

::-webkit-inner-spin-button,
::-webkit-outer-spin-button {
  height: auto;
}

[type="search"] {
  -webkit-appearance: textfield;
  outline-offset: -2px;
}

::-webkit-search-decoration {
  -webkit-appearance: none;
}

::-webkit-file-upload-button {
  -webkit-appearance: button;
  font: inherit;
}

summary {
  display: list-item;
}

blockquote, dd, dl, figure, h1, h2, h3, h4, h5, h6, hr, p, pre {
  margin: 0;
}

fieldset {
  margin: 0;
  padding: 0;
}

legend {
  padding: 0;
}

ol, ul, menu {
  list-style: none;
  margin: 0;
  padding: 0;
}

dialog {
  padding: 0;
}

textarea {
  resize: vertical;
}

input::placeholder,
textarea::placeholder {
  opacity: 1;
  color: var(--color-text-muted);
}

button, [role="button"] {
  cursor: pointer;
}

:disabled {
  cursor: default;
}

img, svg, video, canvas, audio, iframe, embed, object {
  display: block;
  vertical-align: middle;
}

img, video {
  max-width: 100%;
  height: auto;
}

[hidden]:where(:not([hidden="until-found"])) {
  display: none;
}

/* ==================== Base Styles ==================== */
body {
  background-color: var(--color-surface);
  color: var(--color-text);
  font-family: var(--font-sans);
  line-height: 1.625;
  min-height: 100vh;
}

h1, h2, h3, h4, h5, h6 {
  color: var(--color-text-light);
  font-weight: 500;
  letter-spacing: -0.025em;
}

a {
  color: var(--color-primary);
  transition: color 150ms;
}
a:hover {
  color: var(--color-accent);
}

/* ==================== Layout Utilities ==================== */
.flex { display: flex; }
.grid { display: grid; }
.hidden { display: none; }
.inline-flex { display: inline-flex; }
.fixed { position: fixed; }
.absolute { position: absolute; }
.inset-0 { inset: 0; }

.flex-1 { flex: 1 1 0%; }
.flex-col { flex-direction: column; }
.flex-wrap { flex-wrap: wrap; }
.items-center { align-items: center; }
.items-start { align-items: flex-start; }
.justify-between { justify-content: space-between; }
.justify-center { justify-content: center; }
.min-w-0 { min-width: 0; }

.gap-1 { gap: 0.25rem; }
.gap-2 { gap: 0.5rem; }
.gap-3 { gap: 0.75rem; }
.gap-4 { gap: 1rem; }
.gap-x-6 { column-gap: 1.5rem; }
.gap-y-1 { row-gap: 0.25rem; }

.grid-cols-4 { grid-template-columns: repeat(4, minmax(0, 1fr)); }

/* ==================== Spacing Utilities ==================== */
.p-2 { padding: 0.5rem; }
.p-3 { padding: 0.75rem; }
.p-4 { padding: 1rem; }
.p-5 { padding: 1.25rem; }
.p-6 { padding: 1.5rem; }
.p-8 { padding: 2rem; }
.px-2 { padding-left: 0.5rem; padding-right: 0.5rem; }
.px-3 { padding-left: 0.75rem; padding-right: 0.75rem; }
.px-5 { padding-left: 1.25rem; padding-right: 1.25rem; }
.px-6 { padding-left: 1.5rem; padding-right: 1.5rem; }
.py-1 { padding-top: 0.25rem; padding-bottom: 0.25rem; }
.py-3 { padding-top: 0.75rem; padding-bottom: 0.75rem; }
.py-4 { padding-top: 1rem; padding-bottom: 1rem; }
.py-8 { padding-top: 2rem; padding-bottom: 2rem; }
.pl-4 { padding-left: 1rem; }
.pl-5 { padding-left: 1.25rem; }
.pl-8 { padding-left: 2rem; }

.mb-1 { margin-bottom: 0.25rem; }
.mb-3 { margin-bottom: 0.75rem; }
.mb-4 { margin-bottom: 1rem; }
.mb-5 { margin-bottom: 1.25rem; }
.mb-6 { margin-bottom: 1.5rem; }
.mb-8 { margin-bottom: 2rem; }
.ml-2 { margin-left: 0.5rem; }
.ml-auto { margin-left: auto; }
.mt-2 { margin-top: 0.5rem; }
.mt-6 { margin-top: 1.5rem; }
.mt-8 { margin-top: 2rem; }
.mx-auto { margin-left: auto; margin-right: auto; }
.pb-2 { padding-bottom: 0.5rem; }

.space-y-1 > * + * { margin-top: 0.25rem; }
.space-y-2 > * + * { margin-top: 0.5rem; }
.space-y-4 > * + * { margin-top: 1rem; }

/* ==================== Sizing ==================== */
.w-10 { width: 2.5rem; }
.h-10 { height: 2.5rem; }
.w-full { width: 100%; }
.h-full { height: 100%; }
.min-h-screen { min-height: 100vh; }
.max-w-none { max-width: none; }
.max-w-xl { max-width: 36rem; }
.max-w-6xl { max-width: 72rem; }
.w-\[90vw\] { width: 90vw; }
.h-\[85vh\] { height: 85vh; }

/* ==================== Typography ==================== */
.text-xs { font-size: 0.75rem; line-height: 1rem; }
.text-sm { font-size: 0.875rem; line-height: 1.25rem; }
.text-base { font-size: 1rem; line-height: 1.5rem; }
.text-lg { font-size: 1.125rem; line-height: 1.75rem; }
.text-xl { font-size: 1.25rem; line-height: 1.75rem; }
.text-2xl { font-size: 1.5rem; line-height: 2rem; }

.font-medium { font-weight: 500; }
.font-semibold { font-weight: 600; }
.font-mono { font-family: var(--font-mono); }
.tabular-nums { font-variant-numeric: tabular-nums; }
.uppercase { text-transform: uppercase; }
.italic { font-style: italic; }
.tracking-tight { letter-spacing: -0.025em; }
.tracking-wider { letter-spacing: 0.05em; }
.leading-relaxed { line-height: 1.625; }
.truncate { overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.line-through { text-decoration: line-through; }
.underline { text-decoration: underline; }
.text-left { text-align: left; }
.text-center { text-align: center; }
.text-right { text-align: right; }
.list-disc { list-style-type: disc; }

/* ==================== Text Colors ==================== */
.text-white { color: #fff; }
.text-text { color: var(--color-text); }
.text-text-light { color: var(--color-text-light); }
.text-text-muted { color: var(--color-text-muted); }
.text-primary { color: var(--color-primary); }
.text-primary-300 { color: var(--color-primary-300); }
.text-accent { color: var(--color-accent); }
.text-green-400 { color: var(--color-green); }
.text-yellow-400 { color: var(--color-yellow); }
.text-red-400 { color: var(--color-red); }
.text-blue-400 { color: var(--color-blue); }

/* ==================== Background Colors ==================== */
.bg-surface { background-color: var(--color-surface); }
.bg-surface-card { background-color: var(--color-surface-card); }
.bg-surface-elevated { background-color: var(--color-surface-elevated); }
.bg-surface-code { background-color: var(--color-surface-code); }
.bg-primary { background-color: var(--color-primary); }
.bg-primary\/10 { background-color: rgba(64, 81, 181, 0.1); }
.bg-primary\/15 { background-color: rgba(64, 81, 181, 0.15); }
.bg-primary\/20 { background-color: rgba(64, 81, 181, 0.2); }
.bg-green-500\/5 { background-color: rgba(34, 197, 94, 0.05); }
.bg-green-500\/10 { background-color: rgba(34, 197, 94, 0.1); }
.bg-green-500\/15 { background-color: rgba(34, 197, 94, 0.15); }
.bg-red-500\/5 { background-color: rgba(239, 68, 68, 0.05); }
.bg-red-500\/10 { background-color: rgba(239, 68, 68, 0.1); }
.bg-red-500\/15 { background-color: rgba(239, 68, 68, 0.15); }
.bg-yellow-500\/5 { background-color: rgba(234, 179, 8, 0.05); }
.bg-white\/5 { background-color: rgba(255, 255, 255, 0.05); }
.bg-white\/10 { background-color: rgba(255, 255, 255, 0.1); }
.bg-black\/80 { background-color: rgba(0, 0, 0, 0.8); }
.bg-transparent { background-color: transparent; }

/* ==================== Borders ==================== */
.border { border-width: 1px; }
.border-0 { border-width: 0; }
.border-t { border-top-width: 1px; }
.border-b { border-bottom-width: 1px; }
.border-l-4 { border-left-width: 4px; }
.border-l-\[3px\] { border-left-width: 3px; }

.border-white\/5 { border-color: rgba(255, 255, 255, 0.05); }
.border-white\/10 { border-color: rgba(255, 255, 255, 0.1); }
.border-white\/20 { border-color: rgba(255, 255, 255, 0.2); }
.border-primary { border-color: var(--color-primary); }
.border-primary\/30 { border-color: rgba(64, 81, 181, 0.3); }
.border-primary\/50 { border-color: rgba(64, 81, 181, 0.5); }
.border-green-500 { border-color: #22c55e; }
.border-green-500\/30 { border-color: rgba(34, 197, 94, 0.3); }
.border-red-500 { border-color: #ef4444; }
.border-red-500\/30 { border-color: rgba(239, 68, 68, 0.3); }
.border-yellow-500\/30 { border-color: rgba(234, 179, 8, 0.3); }

.rounded { border-radius: 0.25rem; }
.rounded-full { border-radius: 9999px; }
.rounded-lg { border-radius: 0.5rem; }
.rounded-material { border-radius: var(--radius-material); }

/* ==================== Effects ==================== */
.shadow-material { box-shadow: var(--shadow-material); }
.shadow-material-lg { box-shadow: var(--shadow-material-lg); }
.opacity-50 { opacity: 0.5; }
.opacity-70 { opacity: 0.7; }
.backdrop-blur-sm { backdrop-filter: blur(4px); }

.transition-colors { transition-property: color, background-color, border-color; transition-duration: 150ms; transition-timing-function: ease; }
.transition-all { transition-property: all; transition-duration: 150ms; transition-timing-function: ease; }
.transition-transform { transition-property: transform; transition-timing-function: ease; }
.duration-150 { transition-duration: 150ms; }
.duration-200 { transition-duration: 200ms; }
.ease-out { transition-timing-function: ease-out; }

/* ==================== Positioning ==================== */
.top-4 { top: 1rem; }
.right-4 { right: 1rem; }
.z-40 { z-index: 40; }
.z-50 { z-index: 50; }

/* ==================== Overflow & Cursor ==================== */
.overflow-hidden { overflow: hidden; }
.overflow-auto { overflow: auto; }
.overflow-x-auto { overflow-x: auto; }
.overflow-y-auto { overflow-y: auto; }
.cursor-pointer { cursor: pointer; }

/* ==================== Misc Utilities ==================== */
.sr-only {
  position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px;
  overflow: hidden; clip: rect(0,0,0,0); white-space: nowrap; border-width: 0;
}

/* ==================== Hover States ==================== */
.hover\:bg-white\/\[0\.02\]:hover { background-color: rgba(255, 255, 255, 0.02); }
.hover\:bg-white\/\[0\.03\]:hover { background-color: rgba(255, 255, 255, 0.03); }
.hover\:border-white\/20:hover { border-color: rgba(255, 255, 255, 0.2); }
.hover\:border-primary\/30:hover { border-color: rgba(64, 81, 181, 0.3); }
.hover\:border-primary\/50:hover { border-color: rgba(64, 81, 181, 0.5); }
.hover\:text-text-light:hover { color: var(--color-text-light); }
.hover\:text-blue-400:hover { color: var(--color-blue); }
.hover\:text-accent:hover { color: var(--color-accent); }
.hover\:decoration-accent\/50:hover { text-decoration-color: rgba(82, 108, 254, 0.5); }
.decoration-primary\/30 { text-decoration-color: rgba(64, 81, 181, 0.3); }

/* ==================== Gradient ==================== */
.bg-gradient-to-r { background-image: linear-gradient(to right, var(--tw-gradient-stops)); }
.from-purple-500\/10 { --tw-gradient-from: rgba(168, 85, 247, 0.1); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
.via-primary\/10 { --tw-gradient-stops: var(--tw-gradient-from), rgba(64, 81, 181, 0.1), var(--tw-gradient-to, transparent); }
.to-transparent { --tw-gradient-to: transparent; }

/* ============================================================
   Component Classes
   ============================================================ */

/* ==================== Report Header ==================== */
.report-header {
  background-color: var(--color-primary);
  color: #fff;
  border-radius: var(--radius-material);
  padding: 1.5rem;
  margin-bottom: 1.5rem;
  box-shadow: var(--shadow-material);
}
.report-header h1 {
  font-size: 1.5rem;
  line-height: 2rem;
  font-weight: 500;
  margin-bottom: 0.25rem;
  letter-spacing: -0.025em;
}

/* ==================== Status Badges ==================== */
.status-passed {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.25rem 0.75rem;
  border-radius: 9999px;
  background-color: rgba(34, 197, 94, 0.15);
  color: var(--color-green);
  font-weight: 500;
  font-size: 0.875rem;
  line-height: 1.25rem;
  border: 1px solid rgba(34, 197, 94, 0.3);
}
.status-failed {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.25rem 0.75rem;
  border-radius: 9999px;
  background-color: rgba(239, 68, 68, 0.15);
  color: var(--color-red);
  font-weight: 500;
  font-size: 0.875rem;
  line-height: 1.25rem;
  border: 1px solid rgba(239, 68, 68, 0.3);
}

/* ==================== Cards ==================== */
.card {
  background-color: var(--color-surface-card);
  border-radius: var(--radius-material);
  box-shadow: var(--shadow-material);
  border: 1px solid rgba(255, 255, 255, 0.05);
}
.card-header {
  padding: 1.25rem;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  font-weight: 500;
  color: var(--color-text-light);
}
.card-body {
  padding: 1.25rem;
}

/* ==================== Section Title ==================== */
.section-title {
  font-size: 1.125rem;
  line-height: 1.75rem;
  font-weight: 500;
  margin-bottom: 1.25rem;
  display: flex;
  align-items: center;
  gap: 0.75rem;
  color: var(--color-text-light);
}

/* ==================== Tool Name ==================== */
.tool-name {
  font-family: var(--font-mono);
  color: var(--color-accent);
  font-weight: 500;
}

/* ==================== AI Insights ==================== */
.ai-insights {
  background-color: var(--color-surface-card);
  border-radius: var(--radius-material);
  box-shadow: var(--shadow-material);
  border: 1px solid rgba(255, 255, 255, 0.05);
  margin-bottom: 2.5rem;
  overflow: hidden;
}
.ai-insights-header {
  padding: 1.25rem;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  font-weight: 500;
  background-image: linear-gradient(to right, rgba(168, 85, 247, 0.1), rgba(64, 81, 181, 0.1), transparent);
  display: flex;
  align-items: center;
  gap: 0.75rem;
  color: var(--color-text-light);
}

/* ==================== Leaderboard Table ==================== */
.leaderboard-table {
  width: 100%;
  font-size: 0.875rem;
  line-height: 1.25rem;
  border-collapse: collapse;
}
.leaderboard-table th {
  padding: 0.75rem 1.25rem;
  text-align: left;
  font-weight: 500;
  color: var(--color-text-muted);
  text-transform: uppercase;
  font-size: 0.75rem;
  line-height: 1rem;
  letter-spacing: 0.05em;
  background-color: var(--color-surface-elevated);
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}
.leaderboard-table td {
  padding: 1rem 1.25rem;
  border-bottom: 1px solid rgba(255, 255, 255, 0.05);
  color: var(--color-text);
}
.leaderboard-table tbody tr {
  transition: background-color 150ms;
}
.leaderboard-table tbody tr:hover {
  background-color: rgba(255, 255, 255, 0.02);
}
.winner-row {
  background-color: rgba(34, 197, 94, 0.05);
}

/* ==================== Markdown Content ==================== */
.markdown-content {
  max-width: none;
  font-size: 0.875rem;
  line-height: 1.7;
  color: var(--color-text);
}
.markdown-content h2 {
  font-size: 1.125rem;
  line-height: 1.75rem;
  font-weight: 500;
  color: var(--color-text-light);
  margin-top: 2rem;
  margin-bottom: 1rem;
  padding-bottom: 0.5rem;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}
.markdown-content h3 {
  font-size: 1rem;
  line-height: 1.5rem;
  font-weight: 500;
  color: var(--color-text-light);
  margin-top: 1.5rem;
  margin-bottom: 0.75rem;
}
.markdown-content p {
  color: var(--color-text);
  line-height: 1.625;
  margin-bottom: 1rem;
}
.markdown-content ul {
  list-style-type: disc;
  padding-left: 1.25rem;
  color: var(--color-text);
  margin-bottom: 1rem;
}
.markdown-content ul > li + li { margin-top: 0.375rem; }
.markdown-content li {
  color: var(--color-text);
}
.markdown-content li::marker {
  color: var(--color-text-muted);
}
.markdown-content code {
  background-color: var(--color-surface-code);
  padding: 0.125rem 0.375rem;
  border-radius: 0.25rem;
  color: var(--color-accent);
  font-family: var(--font-mono);
  font-size: 0.85em;
  border: 1px solid rgba(255, 255, 255, 0.05);
}
.markdown-content pre {
  background-color: var(--color-surface-code);
  border-radius: var(--radius-material);
  padding: 1rem;
  overflow-x: auto;
  border: 1px solid rgba(255, 255, 255, 0.05);
  margin-bottom: 1rem;
}
.markdown-content pre code {
  background-color: transparent;
  padding: 0;
  border: 0;
  color: var(--color-text);
  font-size: inherit;
}
.markdown-content strong {
  color: var(--color-text-light);
  font-weight: 600;
}
.markdown-content a {
  color: var(--color-primary);
  text-decoration: underline;
  text-decoration-color: rgba(64, 81, 181, 0.3);
  transition: color 150ms, text-decoration-color 150ms;
}
.markdown-content a:hover {
  color: var(--color-accent);
  text-decoration-color: rgba(82, 108, 254, 0.5);
}
.markdown-content blockquote {
  border-left: 4px solid rgba(64, 81, 181, 0.5);
  padding-left: 1rem;
  font-style: italic;
  color: var(--color-text-muted);
}
.markdown-content table {
  width: 100%;
  border-collapse: collapse;
  margin-bottom: 1rem;
}
.markdown-content th,
.markdown-content td {
  padding: 0.5rem 0.75rem;
  border: 1px solid rgba(255, 255, 255, 0.1);
  text-align: left;
}
.markdown-content th {
  background-color: var(--color-surface-elevated);
  font-weight: 500;
  color: var(--color-text-light);
}

/* ==================== Agent Selector ==================== */
.agent-chip {
  cursor: pointer;
  padding: 0.5rem 0.75rem;
  border-radius: var(--radius-material);
  border: 1px solid rgba(255, 255, 255, 0.1);
  background-color: var(--color-surface-card);
  transition: all 150ms;
}
.agent-chip:hover {
  border-color: rgba(64, 81, 181, 0.5);
}
.agent-chip.selected {
  border-color: var(--color-primary);
  background-color: rgba(64, 81, 181, 0.1);
}

/* ==================== Filter Buttons ==================== */
.filter-btn {
  padding: 0.375rem 0.75rem;
  border-radius: 0.25rem;
  font-size: 0.875rem;
  line-height: 1.25rem;
  color: var(--color-text-muted);
  border: 1px solid rgba(255, 255, 255, 0.1);
  background-color: var(--color-surface-card);
  cursor: pointer;
  transition: color 150ms, background-color 150ms, border-color 150ms;
}
.filter-btn:hover {
  border-color: rgba(255, 255, 255, 0.2);
}
.filter-btn.active {
  border-color: var(--color-primary);
  background-color: rgba(64, 81, 181, 0.2);
  color: var(--color-text-light);
}

/* ==================== Group / Expand ==================== */
.test-group.collapsed .group-content { display: none; }
.test-group.collapsed .expand-icon { transform: rotate(-90deg); }
.test-row.hidden { display: none; }
.test-detail.hidden { display: none; }

/* ==================== Overlay ==================== */
#overlay.active { display: flex !important; }
#diagram-hover-popup.active { display: block !important; }
#overlay-mermaid svg {
  max-width: 100%;
  max-height: 100%;
  width: auto;
  height: auto;
  min-height: 60vh;
}
</style></head><body class="bg-surface text-text min-h-screen"><div class="max-w-6xl mx-auto px-6 py-8"><header class="report-header mb-8"><div class="flex justify-between items-start gap-4 mb-4"><div class="flex-1"><h1 class="text-2xl font-medium mb-1">Three agents for testing the agent selector UI.</h1></div><div class="status-failed"><span>âœ—</span><span>1 Failed</span></div></div><div class="flex flex-wrap gap-x-6 gap-y-1 py-3 border-t border-white/10 text-sm"><span class="opacity-70">February 07, 2026 at 07:22 PM</span><span>ğŸ“„ <span class="text-text-light hover:text-blue-400 cursor-pointer" title="tests/fixtures/scenario_04_agent_selector.py">scenario_04_agent_selector.py</span></span><span class="tabular-nums">6 tests</span><span class="tabular-nums">75.7s</span><span class="tabular-nums" title="Token range (min-max per test)">377â€“3,235 tok</span><span class="tabular-nums" title="Test execution cost">ğŸ§ª $-0.008804</span><span class="tabular-nums" title="AI analysis cost">ğŸ¤– $0.0179</span><span class="tabular-nums font-semibold" title="Total cost">ğŸ’° $0.009104</span></div></header><section class="mb-8"><div class="ai-insights"><div class="ai-insights-header"><span>ğŸ¤–</span><span>AI Analysis</span><button class="ml-auto text-text-muted hover:text-text-light text-sm" onclick="this.closest(&#39;.ai-insights&#39;).querySelector(&#39;.card-body&#39;).classList.toggle(&#39;hidden&#39;)">Toggle</button></div><div class="card-body"><div class="markdown-content"><h2>ğŸ¯ Recommendation</h2>
<p><strong>Deploy: gpt-5-mini (default system prompt, no skill)</strong></p>
<p>Achieves <strong>100% pass rate</strong> on required behaviors at <strong>~55% lower total cost</strong> than the skill-augmented variant, while correctly using MCP tools.</p>
<p><strong>Reasoning:</strong><br />
- <strong>Pass rate:</strong> gpt-5-mini (default) passed both tests it was eligible for, including correct tool usage for financial advice. gpt-4.1-mini failed a required tool call and is disqualified.<br />
- <strong>Cost:</strong><br />
  - gpt-5-mini (default): $0.003738 total across tests shown<br />
  - gpt-5-mini + financial-advisor: $0.004824 total (<strong>~29% higher cost</strong>)<br />
- <strong>Response quality:</strong> The default prompt produced cautious, compliant advice (asking for more info) while still grounding responses in real balances via tools. The skill adds richer advice but at significantly higher cost and token usage.</p>
<p><strong>Alternatives:</strong><br />
- <strong>gpt-5-mini + financial-advisor:</strong> Higher-quality financial guidance, but <strong>~29% higher cost</strong> and nearly <strong>2Ã— token usage</strong>. Suitable only if advisory depth is a product requirement.<br />
- <strong>gpt-4.1-mini:</strong> <strong>Disqualified</strong> â€” failed required tool usage in the financial advice test.</p>
<h2>âŒ Failure Analysis</h2>
<h3>Financial advice â€” tests differentiation between agents (skill vs no skill) (gpt-4.1-mini)</h3>
<ul>
<li><strong>Problem:</strong> The agent asked the user for balances instead of retrieving them.</li>
<li><strong>Root Cause:</strong> The system prompt instruction â€œAlways use toolsâ€ was not strong enough to force proactive balance retrieval for advisory questions.</li>
<li><strong>Fix:</strong> Update the system prompt to explicitly require balance lookup for advice:
  <code>Always retrieve relevant account balances using tools before giving any financial advice or recommendations.</code></li>
</ul>
<h2>ğŸ”§ MCP Tool Feedback</h2>
<h3>pytest_aitest.testing.banking_mcp</h3>
<p>Overall, tools are well-defined and correctly used by compliant agents. Tool selection is intuitive.</p>
<table>
<thead>
<tr>
<th>Tool</th>
<th>Status</th>
<th>Calls</th>
<th>Issues</th>
</tr>
</thead>
<tbody>
<tr>
<td>get_balance</td>
<td>âœ…</td>
<td>3</td>
<td>Working well</td>
</tr>
<tr>
<td>get_all_balances</td>
<td>âœ…</td>
<td>2</td>
<td>Working well</td>
</tr>
<tr>
<td>transfer</td>
<td>âš ï¸</td>
<td>0</td>
<td>Not exercised in tests</td>
</tr>
<tr>
<td>deposit</td>
<td>âš ï¸</td>
<td>0</td>
<td>Not exercised in tests</td>
</tr>
<tr>
<td>withdraw</td>
<td>âš ï¸</td>
<td>0</td>
<td>Not exercised in tests</td>
</tr>
<tr>
<td>get_transactions</td>
<td>âš ï¸</td>
<td>0</td>
<td>Not exercised in tests</td>
</tr>
</tbody>
</table>
<h2>ğŸ“ System Prompt Feedback</h2>
<h3>default (mixed)</h3>
<ul>
<li><strong>Token count:</strong> ~20</li>
<li><strong>Problem:</strong> The instruction â€œAlways use toolsâ€ is underspecified for advisory scenarios, leading one model to ask the user instead of calling tools.</li>
<li><strong>Suggested change:</strong> Replace the last line with:
  <code>Always retrieve required account data with tools before answering questions about balances, allocations, or financial advice. Never ask the user for information that tools can provide.</code></li>
</ul>
<h2>ğŸ“š Skill Feedback</h2>
<h3>financial-advisor (positive but expensive)</h3>
<ul>
<li><strong>Usage rate:</strong> High â€” principles and structure clearly reflected in responses</li>
<li><strong>Token cost:</strong> ~700â€“900 extra tokens per test</li>
<li><strong>Problem:</strong> Overkill for simple balance queries; skill content is injected even when not needed.</li>
<li><strong>Suggested change:</strong> Split into two skills:</li>
<li><code>financial-advisor-core</code> (principles + priorities only)</li>
<li><code>financial-advisor-budgeting</code> (detailed categories and red flags)</li>
</ul>
<h2>ğŸ’¡ Optimizations</h2>
<ol>
<li><strong>Conditional Skill Injection</strong> (recommended)</li>
<li>Current: Financial advisor skill is always loaded.</li>
<li>Change: Only attach the skill for tests or routes involving â€œadviceâ€, â€œbudgetâ€, or â€œallocationâ€.</li>
<li>
<p>Impact: <strong>25â€“35% cost reduction</strong> on non-advisory queries (~700â€“900 fewer tokens per call).</p>
</li>
<li>
<p><strong>Stronger Tool-Use Directive</strong> (recommended)</p>
</li>
<li>Current: Models interpret â€œAlways use toolsâ€ inconsistently.</li>
<li>Change: Add explicit requirement to fetch balances before advice (see prompt fix above).</li>
<li>Impact: Prevents tool-miss failures, eliminating retries and failed tests (saves ~$0.0002 per failure).</li>
</ol></div></div></div></section><section class="mb-8"><h2 class="section-title">ğŸ† Agent Leaderboard</h2><div class="card overflow-hidden"><table class="leaderboard-table"><thead><tr><th class="w-10"></th><th>Agent</th><th class="text-center">Tests</th><th class="text-center">Pass Rate</th><th class="text-right">Tokens</th><th class="text-right">Cost</th><th class="text-right">Duration</th></tr></thead><tbody><tr class="winner-row"><td class="text-center text-xl">ğŸ¥‡</td><td><div class="font-medium text-text-light"><span>gpt-5-mini</span></div></td><td class="text-center tabular-nums"><span class="text-green-400">2</span>/<span class="text-text-muted">2</span></td><td class="text-center"><span class="text-green-400 font-semibold tabular-nums">100%</span></td><td class="text-right tabular-nums text-text-muted">3,448</td><td class="text-right tabular-nums text-text-muted">$0.003737</td><td class="text-right tabular-nums text-text-muted">31.1s</td></tr><tr><td class="text-center text-xl">ğŸ¥ˆ</td><td><div class="font-medium text-text-light"><span>gpt-5-mini + financial-advisor</span></div></td><td class="text-center tabular-nums"><span class="text-green-400">2</span>/<span class="text-text-muted">2</span></td><td class="text-center"><span class="text-green-400 font-semibold tabular-nums">100%</span></td><td class="text-right tabular-nums text-text-muted">4,908</td><td class="text-right tabular-nums text-text-muted">$0.004823</td><td class="text-right tabular-nums text-text-muted">33.3s</td></tr><tr><td class="text-center text-xl">ğŸ¥‰</td><td><div class="font-medium text-text-light"><span>gpt-4.1-mini</span></div></td><td class="text-center tabular-nums"><span class="text-green-400">1</span>/<span class="text-text-muted">2</span></td><td class="text-center"><span class="text-red-400 font-semibold tabular-nums">50%</span></td><td class="text-right tabular-nums text-text-muted">1,113</td><td class="text-right tabular-nums text-text-muted">$0.000544</td><td class="text-right tabular-nums text-text-muted">11.3s</td></tr></tbody></table></div></section><section class="mb-8"><div class="card p-4"><div class="flex items-center gap-3 mb-3"><span class="text-sm text-text-muted">Compare:</span><span class="text-xs text-text-muted opacity-70">(Click to swap agents)</span></div><div class="flex flex-wrap gap-2"><label class="agent-chip selected"><input type="checkbox" name="compare-agent" value="be927112-ef05-4e33-9522-fc0e896802ae" checked="checked" class="sr-only" onchange="updateAgentComparison(&#39;be927112-ef05-4e33-9522-fc0e896802ae&#39;)"><span class="truncate">gpt-5-mini</span><span class="text-xs text-text-muted tabular-nums">100%</span></label><label class="agent-chip selected"><input type="checkbox" name="compare-agent" value="14c561dd-18dd-4730-a19e-13053d8b33f7" checked="checked" class="sr-only" onchange="updateAgentComparison(&#39;14c561dd-18dd-4730-a19e-13053d8b33f7&#39;)"><span class="truncate">gpt-5-mini + financial-advisor</span><span class="text-xs text-text-muted tabular-nums">100%</span></label><label class="agent-chip "><input type="checkbox" name="compare-agent" value="e32f86b7-b835-4ea4-8e57-d83719f1e9d9" class="sr-only" onchange="updateAgentComparison(&#39;e32f86b7-b835-4ea4-8e57-d83719f1e9d9&#39;)"><span class="truncate">gpt-4.1-mini</span><span class="text-xs text-text-muted tabular-nums">50%</span></label></div></div></section><section class="mb-8"><h2 class="section-title">ğŸ“‹ Test Results</h2><div class="mb-4 flex items-center justify-between"><div class="flex gap-2"><button class="filter-btn active" data-filter="all" onclick="filterTests(&#39;all&#39;)">All</button><button class="filter-btn " data-filter="diff" onclick="filterTests(&#39;diff&#39;)">Differences âš¡</button><button class="filter-btn " data-filter="failed" onclick="filterTests(&#39;failed&#39;)">Failed âŒ</button></div><div class="text-sm text-text-muted"><span id="visible-count">6</span> / 6 tests</div></div><div class="space-y-4" id="test-groups"><div class="card overflow-hidden test-group" data-group-type="standalone"><div class="group-header px-5 py-3 bg-surface-elevated border-b border-white/10 flex justify-between items-center cursor-pointer" onclick="toggleGroup(this.parentElement)"><div class="flex items-center gap-3"><span class="text-lg">ğŸ“‹</span><span class="font-medium text-text-light">tests/fixtures/scenario_04_agent_selector.py</span><span class="text-sm text-text-muted">(2 tests)</span></div><div class="flex items-center gap-4"><div class="text-sm text-green-400">2/2</div><div class="text-sm text-green-400">2/2</div><span class="text-text-muted transition-transform duration-200 expand-icon">â–¼</span></div></div><div class="group-content"><div class="test-row border-b border-white/5" data-test-id="test_balance_query" data-has-diff="false" data-has-failed="false"><div class="px-5 py-3 hover:bg-white/[0.02] cursor-pointer transition-colors" onclick="toggleTestDetail(this.parentElement)"><div class="flex items-center justify-between"><div class="flex items-center gap-3 min-w-0 flex-1"><span class="text-green-400">âœ…</span><span class="text-text-light truncate">Basic balance query â€” all agents should pass.</span></div><div class="flex items-center gap-4 text-sm text-text-muted"><span class="tabular-nums" title="Total tokens across selected agents">Total 2,595 tok</span><span class="text-text-muted">Â·</span><span class="tabular-nums" title="Total cost across selected agents">Total $0.001224</span><span class="text-text-muted">Â·</span><span class="tabular-nums" title="Token difference between selected agents (%difference)">Î” +81%</span><span class="text-text-muted">Â·</span><span class="tabular-nums" title="Duration difference between selected agents (%difference)">Î” +31%</span><span class="text-text-muted">Â·</span><span class="tabular-nums" title="Cost difference between selected agents (%difference)">Î” +183%</span></div></div><div class="flex gap-4 mt-2 pl-8"><div class="agent-result-item flex items-center gap-2 text-xs " data-agent-id="be927112-ef05-4e33-9522-fc0e896802ae"><span class="text-text-muted">gpt-5-mini:</span><span class="text-green-400">âœ…</span><span class="text-text-muted tabular-nums">11.1s</span></div><div class="agent-result-item flex items-center gap-2 text-xs " data-agent-id="14c561dd-18dd-4730-a19e-13053d8b33f7"><span class="text-text-muted">gpt-5-mini + financial-advisor:</span><span class="text-green-400">âœ…</span><span class="text-text-muted tabular-nums">8.5s</span></div><div class="agent-result-item flex items-center gap-2 text-xs hidden" data-agent-id="e32f86b7-b835-4ea4-8e57-d83719f1e9d9"><span class="text-text-muted">gpt-4.1-mini:</span><span class="text-green-400">âœ…</span><span class="text-text-muted tabular-nums">6.9s</span></div></div></div><div class="test-detail hidden border-t border-white/10 bg-surface-elevated"><div class="comparison-grid grid gap-4 p-5" style="grid-template-columns: repeat(2, 1fr);"><div class="comparison-column  border-l-[3px] border-green-500" data-agent-id="be927112-ef05-4e33-9522-fc0e896802ae"><div class="flex items-center justify-between mb-4"><div class="font-medium text-text-light">gpt-5-mini</div><span class="px-2 py-0.5 rounded text-xs font-medium bg-green-500/15 text-green-400">passed</span></div><div class="space-y-2 mb-4"><div class="grid grid-cols-4 gap-2 p-3 bg-surface-elevated rounded-material text-center"><div><div class="text-sm font-medium text-text-light tabular-nums">11.07s</div><div class="text-xs text-text-muted">duration</div></div><div><div class="text-sm font-medium text-text-light tabular-nums">3</div><div class="text-xs text-text-muted">turns</div></div><div><div class="text-sm font-medium text-text-light tabular-nums">1</div><div class="text-xs text-text-muted">tools</div></div><div><div class="text-sm font-medium text-text-light tabular-nums">922</div><div class="text-xs text-text-muted">tokens</div></div></div><div class="grid grid-cols-4 gap-2 p-3 bg-surface-elevated rounded-material text-center"><div><div class="text-sm font-medium text-text-light tabular-nums">$0.000320</div><div class="text-xs text-text-muted">cost</div></div></div></div><div class="mb-4"><div class="text-sm font-medium text-text-light mb-3 flex items-center gap-2"><span>ğŸ“Š</span><span>Sequence</span></div><div class="p-3 bg-surface-code rounded-material border border-white/5 cursor-pointer hover:border-primary/30 transition-colors" onclick="event.stopPropagation(); showDiagram(this.dataset.mermaidCode);" data-mermaid-code="sequenceDiagram
    participant User
    participant Agent
    participant Tools

    User-&gt;&gt;Agent: &#34;What&#39;s my checking account balance?&#34;
    Agent-&gt;&gt;Tools: &#34;get_balance({&#39;account&#39;: &#39;checking&#39;})&#34;
    Tools--&gt;&gt;Agent: &#34;{&#39;account&#39;: &#39;checking&#39;, &#39;balance&#39;: 1500.0, &#39;formatted&#39;: &#39;$1,&#34;
    Agent-&gt;&gt;User: &#34;Your checking account balance is $1,500.00. Would you like to do anything else w&#34;"><div class="mermaid text-xs">sequenceDiagram
    participant User
    participant Agent
    participant Tools

    User->>Agent: "What's my checking account balance?"
    Agent->>Tools: "get_balance({'account': 'checking'})"
    Tools-->>Agent: "{'account': 'checking', 'balance': 1500.0, 'formatted': '$1,"
    Agent->>User: "Your checking account balance is $1,500.00. Would you like to do anything else w"</div></div></div><div class="mb-4"><div class="text-sm font-medium text-text-light mb-3 flex items-center gap-2"><span>ğŸ”§</span><span>Tool Calls</span></div><div class="space-y-1"><div class="flex items-center gap-2 text-sm p-2 rounded bg-green-500/5"><span class="text-green-400">âœ…</span><code class="tool-name">get_balance</code></div></div></div><div class="mb-4"><div class="text-sm font-medium text-text-light mb-3 flex items-center gap-2"><span>âœ“</span><span>Assertions</span></div><div class="space-y-2"><div class="flex items-center gap-2 text-sm p-2 rounded bg-green-500/5"><span class="text-green-400">âœ…</span><code class="text-text-muted">llm</code><span class="text-text">provides the current checking account balance amount</span></div></div></div><div class="mb-4"><div class="text-sm font-medium text-text-light mb-3 flex items-center gap-2"><span>ğŸ’¬</span><span>Response</span></div><div style="padding: 1rem; background-color: var(--color-surface-elevated); border-radius: 0.5rem; color: var(--color-text); white-space: pre-wrap; word-wrap: break-word; line-height: 1.625;">Your checking account balance is $1,500.00. Would you like to do anything else with this account?</div></div></div><div class="comparison-column  border-l-[3px] border-green-500" data-agent-id="14c561dd-18dd-4730-a19e-13053d8b33f7"><div class="flex items-center justify-between mb-4"><div class="font-medium text-text-light">gpt-5-mini + financial-advisor</div><span class="px-2 py-0.5 rounded text-xs font-medium bg-green-500/15 text-green-400">passed</span></div><div class="space-y-2 mb-4"><div class="grid grid-cols-4 gap-2 p-3 bg-surface-elevated rounded-material text-center"><div><div class="text-sm font-medium text-text-light tabular-nums">8.48s</div><div class="text-xs text-text-muted">duration</div></div><div><div class="text-sm font-medium text-text-light tabular-nums">3</div><div class="text-xs text-text-muted">turns</div></div><div><div class="text-sm font-medium text-text-light tabular-nums">1</div><div class="text-xs text-text-muted">tools</div></div><div><div class="text-sm font-medium text-text-light tabular-nums">1,673</div><div class="text-xs text-text-muted">tokens</div></div></div><div class="grid grid-cols-4 gap-2 p-3 bg-surface-elevated rounded-material text-center"><div><div class="text-sm font-medium text-text-light tabular-nums">$0.000905</div><div class="text-xs text-text-muted">cost</div></div></div></div><div class="mb-4"><div class="text-sm font-medium text-text-light mb-3 flex items-center gap-2"><span>ğŸ“Š</span><span>Sequence</span></div><div class="p-3 bg-surface-code rounded-material border border-white/5 cursor-pointer hover:border-primary/30 transition-colors" onclick="event.stopPropagation(); showDiagram(this.dataset.mermaidCode);" data-mermaid-code="sequenceDiagram
    participant User
    participant Agent
    participant Tools

    User-&gt;&gt;Agent: &#34;What&#39;s my checking account balance?&#34;
    Agent-&gt;&gt;Tools: &#34;get_balance({&#39;account&#39;: &#39;checking&#39;})&#34;
    Tools--&gt;&gt;Agent: &#34;{&#39;account&#39;: &#39;checking&#39;, &#39;balance&#39;: 1500.0, &#39;formatted&#39;: &#39;$1,&#34;
    Agent-&gt;&gt;User: &#34;Your checking account balance is $1,500.00. Would you like me to: - Show your sa&#34;"><div class="mermaid text-xs">sequenceDiagram
    participant User
    participant Agent
    participant Tools

    User->>Agent: "What's my checking account balance?"
    Agent->>Tools: "get_balance({'account': 'checking'})"
    Tools-->>Agent: "{'account': 'checking', 'balance': 1500.0, 'formatted': '$1,"
    Agent->>User: "Your checking account balance is $1,500.00. Would you like me to: - Show your sa"</div></div></div><div class="mb-4"><div class="text-sm font-medium text-text-light mb-3 flex items-center gap-2"><span>ğŸ”§</span><span>Tool Calls</span></div><div class="space-y-1"><div class="flex items-center gap-2 text-sm p-2 rounded bg-green-500/5"><span class="text-green-400">âœ…</span><code class="tool-name">get_balance</code></div></div></div><div class="mb-4"><div class="text-sm font-medium text-text-light mb-3 flex items-center gap-2"><span>âœ“</span><span>Assertions</span></div><div class="space-y-2"><div class="flex items-center gap-2 text-sm p-2 rounded bg-green-500/5"><span class="text-green-400">âœ…</span><code class="text-text-muted">llm</code><span class="text-text">provides the current checking account balance amount</span></div></div></div><div class="mb-4"><div class="text-sm font-medium text-text-light mb-3 flex items-center gap-2"><span>ğŸ’¬</span><span>Response</span></div><div style="padding: 1rem; background-color: var(--color-surface-elevated); border-radius: 0.5rem; color: var(--color-text); white-space: pre-wrap; word-wrap: break-word; line-height: 1.625;">Your checking account balance is $1,500.00.

Would you like me to:
- Show your savings balance or recent transactions?
- Transfer money between accounts or deposit/withdraw?
- Help set up a budget or savings plan (emergency fund recommendations)?</div></div></div><div class="comparison-column hidden border-l-[3px] border-green-500" data-agent-id="e32f86b7-b835-4ea4-8e57-d83719f1e9d9"><div class="flex items-center justify-between mb-4"><div class="font-medium text-text-light">gpt-4.1-mini</div><span class="px-2 py-0.5 rounded text-xs font-medium bg-green-500/15 text-green-400">passed</span></div><div class="space-y-2 mb-4"><div class="grid grid-cols-4 gap-2 p-3 bg-surface-elevated rounded-material text-center"><div><div class="text-sm font-medium text-text-light tabular-nums">6.87s</div><div class="text-xs text-text-muted">duration</div></div><div><div class="text-sm font-medium text-text-light tabular-nums">3</div><div class="text-xs text-text-muted">turns</div></div><div><div class="text-sm font-medium text-text-light tabular-nums">1</div><div class="text-xs text-text-muted">tools</div></div><div><div class="text-sm font-medium text-text-light tabular-nums">736</div><div class="text-xs text-text-muted">tokens</div></div></div><div class="grid grid-cols-4 gap-2 p-3 bg-surface-elevated rounded-material text-center"><div><div class="text-sm font-medium text-text-light tabular-nums">$0.000341</div><div class="text-xs text-text-muted">cost</div></div></div></div><div class="mb-4"><div class="text-sm font-medium text-text-light mb-3 flex items-center gap-2"><span>ğŸ“Š</span><span>Sequence</span></div><div class="p-3 bg-surface-code rounded-material border border-white/5 cursor-pointer hover:border-primary/30 transition-colors" onclick="event.stopPropagation(); showDiagram(this.dataset.mermaidCode);" data-mermaid-code="sequenceDiagram
    participant User
    participant Agent
    participant Tools

    User-&gt;&gt;Agent: &#34;What&#39;s my checking account balance?&#34;
    Agent-&gt;&gt;Tools: &#34;get_balance({&#39;account&#39;: &#39;checking&#39;})&#34;
    Tools--&gt;&gt;Agent: &#34;{&#39;account&#39;: &#39;checking&#39;, &#39;balance&#39;: 1500.0, &#39;formatted&#39;: &#39;$1,&#34;
    Agent-&gt;&gt;User: &#34;Your checking account balance is $1,500.00. Is there anything else you would lik&#34;"><div class="mermaid text-xs">sequenceDiagram
    participant User
    participant Agent
    participant Tools

    User->>Agent: "What's my checking account balance?"
    Agent->>Tools: "get_balance({'account': 'checking'})"
    Tools-->>Agent: "{'account': 'checking', 'balance': 1500.0, 'formatted': '$1,"
    Agent->>User: "Your checking account balance is $1,500.00. Is there anything else you would lik"</div></div></div><div class="mb-4"><div class="text-sm font-medium text-text-light mb-3 flex items-center gap-2"><span>ğŸ”§</span><span>Tool Calls</span></div><div class="space-y-1"><div class="flex items-center gap-2 text-sm p-2 rounded bg-green-500/5"><span class="text-green-400">âœ…</span><code class="tool-name">get_balance</code></div></div></div><div class="mb-4"><div class="text-sm font-medium text-text-light mb-3 flex items-center gap-2"><span>âœ“</span><span>Assertions</span></div><div class="space-y-2"><div class="flex items-center gap-2 text-sm p-2 rounded bg-green-500/5"><span class="text-green-400">âœ…</span><code class="text-text-muted">llm</code><span class="text-text">provides the current checking account balance amount</span></div></div></div><div class="mb-4"><div class="text-sm font-medium text-text-light mb-3 flex items-center gap-2"><span>ğŸ’¬</span><span>Response</span></div><div style="padding: 1rem; background-color: var(--color-surface-elevated); border-radius: 0.5rem; color: var(--color-text); white-space: pre-wrap; word-wrap: break-word; line-height: 1.625;">Your checking account balance is $1,500.00. Is there anything else you would like to do?</div></div></div></div></div></div><div class="test-row border-b border-white/5" data-test-id="test_financial_planning" data-has-diff="true" data-has-failed="true"><div class="px-5 py-3 hover:bg-white/[0.02] cursor-pointer transition-colors" onclick="toggleTestDetail(this.parentElement)"><div class="flex items-center justify-between"><div class="flex items-center gap-3 min-w-0 flex-1"><span class="text-green-400">âœ…</span><span class="text-text-light truncate">Financial advice â€” tests differentiation between agents (skiâ€¦</span><span class="text-yellow-400" title="Results differ between agents">âš¡</span></div><div class="flex items-center gap-4 text-sm text-text-muted"><span class="tabular-nums" title="Total tokens across selected agents">Total 5,761 tok</span><span class="text-text-muted">Â·</span><span class="tabular-nums" title="Total cost across selected agents">Total $0.007336</span><span class="text-text-muted">Â·</span><span class="tabular-nums" title="Token difference between selected agents (%difference)">Î” +28%</span><span class="text-text-muted">Â·</span><span class="tabular-nums" title="Duration difference between selected agents (%difference)">Î” +24%</span><span class="text-text-muted">Â·</span><span class="tabular-nums" title="Cost difference between selected agents (%difference)">Î” +15%</span></div></div><div class="flex gap-4 mt-2 pl-8"><div class="agent-result-item flex items-center gap-2 text-xs " data-agent-id="be927112-ef05-4e33-9522-fc0e896802ae"><span class="text-text-muted">gpt-5-mini:</span><span class="text-green-400">âœ…</span><span class="text-text-muted tabular-nums">20.1s</span></div><div class="agent-result-item flex items-center gap-2 text-xs " data-agent-id="14c561dd-18dd-4730-a19e-13053d8b33f7"><span class="text-text-muted">gpt-5-mini + financial-advisor:</span><span class="text-green-400">âœ…</span><span class="text-text-muted tabular-nums">24.8s</span></div><div class="agent-result-item flex items-center gap-2 text-xs hidden" data-agent-id="e32f86b7-b835-4ea4-8e57-d83719f1e9d9"><span class="text-text-muted">gpt-4.1-mini:</span><span class="text-red-400">âŒ</span><span class="text-text-muted tabular-nums">4.5s</span></div></div></div><div class="test-detail hidden border-t border-white/10 bg-surface-elevated"><div class="comparison-grid grid gap-4 p-5" style="grid-template-columns: repeat(2, 1fr);"><div class="comparison-column  border-l-[3px] border-green-500" data-agent-id="be927112-ef05-4e33-9522-fc0e896802ae"><div class="flex items-center justify-between mb-4"><div class="font-medium text-text-light">gpt-5-mini</div><span class="px-2 py-0.5 rounded text-xs font-medium bg-green-500/15 text-green-400">passed</span></div><div class="space-y-2 mb-4"><div class="grid grid-cols-4 gap-2 p-3 bg-surface-elevated rounded-material text-center"><div><div class="text-sm font-medium text-text-light tabular-nums">20.05s</div><div class="text-xs text-text-muted">duration</div></div><div><div class="text-sm font-medium text-text-light tabular-nums">3</div><div class="text-xs text-text-muted">turns</div></div><div><div class="text-sm font-medium text-text-light tabular-nums">1</div><div class="text-xs text-text-muted">tools</div></div><div><div class="text-sm font-medium text-text-light tabular-nums">2,526</div><div class="text-xs text-text-muted">tokens</div></div></div><div class="grid grid-cols-4 gap-2 p-3 bg-surface-elevated rounded-material text-center"><div><div class="text-sm font-medium text-text-light tabular-nums">$0.003418</div><div class="text-xs text-text-muted">cost</div></div></div></div><div class="mb-4"><div class="text-sm font-medium text-text-light mb-3 flex items-center gap-2"><span>ğŸ“Š</span><span>Sequence</span></div><div class="p-3 bg-surface-code rounded-material border border-white/5 cursor-pointer hover:border-primary/30 transition-colors" onclick="event.stopPropagation(); showDiagram(this.dataset.mermaidCode);" data-mermaid-code="sequenceDiagram
    participant User
    participant Agent
    participant Tools

    User-&gt;&gt;Agent: &#34;I have money in checking and savings. How should I allocate my funds?&#34;
    Agent-&gt;&gt;Tools: &#34;get_all_balances({})&#34;
    Tools--&gt;&gt;Agent: &#34;{&#39;accounts&#39;: {&#39;checking&#39;: {&#39;balance&#39;: 1500.0, &#39;formatted&#39;: &#39;&#34;
    Agent-&gt;&gt;User: &#34;I pulled your balances: checking $1,500 and savings $3,000 (total $4,500). I can&#34;"><div class="mermaid text-xs">sequenceDiagram
    participant User
    participant Agent
    participant Tools

    User->>Agent: "I have money in checking and savings. How should I allocate my funds?"
    Agent->>Tools: "get_all_balances({})"
    Tools-->>Agent: "{'accounts': {'checking': {'balance': 1500.0, 'formatted': '"
    Agent->>User: "I pulled your balances: checking $1,500 and savings $3,000 (total $4,500). I can"</div></div></div><div class="mb-4"><div class="text-sm font-medium text-text-light mb-3 flex items-center gap-2"><span>ğŸ”§</span><span>Tool Calls</span></div><div class="space-y-1"><div class="flex items-center gap-2 text-sm p-2 rounded bg-green-500/5"><span class="text-green-400">âœ…</span><code class="tool-name">get_all_balances</code></div></div></div><div class="mb-4"><div class="text-sm font-medium text-text-light mb-3 flex items-center gap-2"><span>âœ“</span><span>Assertions</span></div><div class="space-y-2"><div class="flex items-center gap-2 text-sm p-2 rounded bg-green-500/5"><span class="text-green-400">âœ…</span><code class="text-text-muted">llm</code><span class="text-text">provides financial advice about fund allocation</span></div></div></div><div class="mb-4"><div class="text-sm font-medium text-text-light mb-3 flex items-center gap-2"><span>ğŸ’¬</span><span>Response</span></div><div style="padding: 1rem; background-color: var(--color-surface-elevated); border-radius: 0.5rem; color: var(--color-text); white-space: pre-wrap; word-wrap: break-word; line-height: 1.625;">I pulled your balances: checking $1,500 and savings $3,000 (total $4,500).

I can give a useful recommendation, but to tailor it I need a couple quick facts:
- Rough monthly living expenses (rent/mortgage, utilities, food, transport)
- Any upcoming big payments (car, vacation, home down payment) in the next 12 months
- Whether you have highâ€‘interest debt or want to invest/retire sooner

Until then, here are clear, practical options you can choose from (I wonâ€™t move any money unless you ask me to):

1) Safety-first (emergency fund focus)
- Keep 1â€“2 months of expenses in checking for bills/buffers.
- Put the rest in savings until you reach a 3â€“6 month emergency fund.
Example if your monthly expenses are ~$1,500: keep $1,500 in checking (you already have that) and keep the $3,000 in savings as a 2â€‘month starter emergency fund. Then build from there.

2) Balanced (short-term goals + emergency)
- Checking: 1 month of expenses
- Savings: emergency fund (3 months) + separate sub-accounts for short-term goals (vacation, car, etc.)
- Any extra beyond emergency goes to goal accounts or investments.
Example split of your $4,500 (if monthly expenses ~$1,500): $1,500 checking / $4,500 total â†’ target savings $4,500 for 3 months; youâ€™d need to add $1,500 to savingsâ€”plan to divert extra income until target met.

3) Growth-forward (invest / pay down debt)
- Keep a 1â€‘month buffer in checking, keep 3 months in savings, then direct remaining funds to highâ€‘priority debt payoff or investments (IRA/brokerage).
Example: if youâ€™re comfortable with less cash cushion, keep $1,500 checking, $1,500 savings (partial emergency), and invest or use remaining $1,500 to pay down debt or invest.

Next steps I can do for you (tell me which and Iâ€™ll execute):
- Reallocate between your checking and savings (specify amounts), e.g., â€œMove $X from savings to checking.â€
- Help set a target emergency fund and show how much more you need.
- Create suggested amounts to invest or pay down debt, and prepare a transfer.

Which scenario fits you, and what are your monthly expenses and goals? If you want me to move money now, tell me the exact transfer (from, to, amount) and Iâ€™ll run it.</div></div></div><div class="comparison-column  border-l-[3px] border-green-500" data-agent-id="14c561dd-18dd-4730-a19e-13053d8b33f7"><div class="flex items-center justify-between mb-4"><div class="font-medium text-text-light">gpt-5-mini + financial-advisor</div><span class="px-2 py-0.5 rounded text-xs font-medium bg-green-500/15 text-green-400">passed</span></div><div class="space-y-2 mb-4"><div class="grid grid-cols-4 gap-2 p-3 bg-surface-elevated rounded-material text-center"><div><div class="text-sm font-medium text-text-light tabular-nums">24.79s</div><div class="text-xs text-text-muted">duration</div></div><div><div class="text-sm font-medium text-text-light tabular-nums">3</div><div class="text-xs text-text-muted">turns</div></div><div><div class="text-sm font-medium text-text-light tabular-nums">1</div><div class="text-xs text-text-muted">tools</div></div><div><div class="text-sm font-medium text-text-light tabular-nums">3,235</div><div class="text-xs text-text-muted">tokens</div></div></div><div class="grid grid-cols-4 gap-2 p-3 bg-surface-elevated rounded-material text-center"><div><div class="text-sm font-medium text-text-light tabular-nums">$0.003919</div><div class="text-xs text-text-muted">cost</div></div></div></div><div class="mb-4"><div class="text-sm font-medium text-text-light mb-3 flex items-center gap-2"><span>ğŸ“Š</span><span>Sequence</span></div><div class="p-3 bg-surface-code rounded-material border border-white/5 cursor-pointer hover:border-primary/30 transition-colors" onclick="event.stopPropagation(); showDiagram(this.dataset.mermaidCode);" data-mermaid-code="sequenceDiagram
    participant User
    participant Agent
    participant Tools

    User-&gt;&gt;Agent: &#34;I have money in checking and savings. How should I allocate my funds?&#34;
    Agent-&gt;&gt;Tools: &#34;get_all_balances({})&#34;
    Tools--&gt;&gt;Agent: &#34;{&#39;accounts&#39;: {&#39;checking&#39;: {&#39;balance&#39;: 1500.0, &#39;formatted&#39;: &#39;&#34;
    Agent-&gt;&gt;User: &#34;Thanks â€” I checked your accounts: you have $1,500 in checking and $3,000 in savi&#34;"><div class="mermaid text-xs">sequenceDiagram
    participant User
    participant Agent
    participant Tools

    User->>Agent: "I have money in checking and savings. How should I allocate my funds?"
    Agent->>Tools: "get_all_balances({})"
    Tools-->>Agent: "{'accounts': {'checking': {'balance': 1500.0, 'formatted': '"
    Agent->>User: "Thanks â€” I checked your accounts: you have $1,500 in checking and $3,000 in savi"</div></div></div><div class="mb-4"><div class="text-sm font-medium text-text-light mb-3 flex items-center gap-2"><span>ğŸ”§</span><span>Tool Calls</span></div><div class="space-y-1"><div class="flex items-center gap-2 text-sm p-2 rounded bg-green-500/5"><span class="text-green-400">âœ…</span><code class="tool-name">get_all_balances</code></div></div></div><div class="mb-4"><div class="text-sm font-medium text-text-light mb-3 flex items-center gap-2"><span>âœ“</span><span>Assertions</span></div><div class="space-y-2"><div class="flex items-center gap-2 text-sm p-2 rounded bg-green-500/5"><span class="text-green-400">âœ…</span><code class="text-text-muted">llm</code><span class="text-text">provides financial advice about fund allocation</span></div></div></div><div class="mb-4"><div class="text-sm font-medium text-text-light mb-3 flex items-center gap-2"><span>ğŸ’¬</span><span>Response</span></div><div style="padding: 1rem; background-color: var(--color-surface-elevated); border-radius: 0.5rem; color: var(--color-text); white-space: pre-wrap; word-wrap: break-word; line-height: 1.625;">Thanks â€” I checked your accounts: you have $1,500 in checking and $3,000 in savings for a total of $4,500.

High-level recommendations (priority order)
1. Emergency fund first â€” 3â€“6 months of your essential expenses kept in savings (separate, ideally in a highâ€‘yield savings account).
2. Pay down any highâ€‘interest debt (credit cards, payday loans) once you have at least a small emergency buffer.
3. Contribute to retirement, at least enough to get any employer match.
4. Other goals (vacation, home down payment) after the above.

Why I need more info
- To give specific targets I need your monthly takeâ€‘home pay and your monthly essential expenses (rent/mortgage, utilities, groceries, transportation, minimum debt payments). Also tell me if you have highâ€‘interest debt or an employer match.

Immediate, practical steps you can take now
- Keep enough in checking to cover upcoming bills and one month of expected spending. Move the rest to savings (or better, a highâ€‘yield savings account).
- Automate &#34;pay yourself first&#34;: schedule an automatic transfer from checking to savings right after each payday.
- If you have highâ€‘interest debt (&gt;7â€“10% APR), prioritize paying that down after you have a small emergency buffer (~$1,000) or at least 1 month of expenses.
- If you have an employer 401(k) match, make sure youâ€™re contributing at least enough to get the full match.

How to apply the 50/30/20 rule (use your takeâ€‘home pay)
- 50% needs (housing, utilities, groceries, transportation)
- 30% wants (dining out, entertainment)
- 20% savings &amp; debt repayment (emergency fund, retirement, extra debt payments)

Quick example (illustrative)
- If your monthly takeâ€‘home pay = $3,000 and your essential monthly expenses = $2,000:
  - 3 months of expenses = $6,000 emergency fund target.
  - You currently have $3,000 in savings â†’ need $3,000 more.
  - Keep $2,000 in checking for bills (you currently have $1,500, so you may want to top it up).
  - Set an automated transfer of $500/month from checking â†’ savings until the emergency fund is met (would take ~6 months).

Red flags to watch for
- Spending more than your income
- No emergency fund or underfunded emergency fund for your situation
- High credit utilization or highâ€‘APR debt
- Spending on dining/entertainment that outpaces savings

Next steps I can do for you
- Create a specific monthly plan if you tell me: monthly takeâ€‘home pay, monthly essential expenses, any highâ€‘interest debt balances &amp; rates, and whether you get a 401(k) match.
- If you want, I can also move money between your checking and savings (tell me how much and which direction) or pull recent transactions so we can categorize spending.

Which would you like to do next? Provide your monthly numbers and any debt/retirement details and Iâ€™ll give a concrete allocation plan.</div></div></div><div class="comparison-column hidden border-l-[3px] border-red-500" data-agent-id="e32f86b7-b835-4ea4-8e57-d83719f1e9d9"><div class="flex items-center justify-between mb-4"><div class="font-medium text-text-light">gpt-4.1-mini</div><span class="px-2 py-0.5 rounded text-xs font-medium bg-red-500/15 text-red-400">failed</span></div><div class="space-y-2 mb-4"><div class="grid grid-cols-4 gap-2 p-3 bg-surface-elevated rounded-material text-center"><div><div class="text-sm font-medium text-text-light tabular-nums">4.46s</div><div class="text-xs text-text-muted">duration</div></div><div><div class="text-sm font-medium text-text-light tabular-nums">2</div><div class="text-xs text-text-muted">turns</div></div><div><div class="text-sm font-medium text-text-light tabular-nums">0</div><div class="text-xs text-text-muted">tools</div></div><div><div class="text-sm font-medium text-text-light tabular-nums">377</div><div class="text-xs text-text-muted">tokens</div></div></div><div class="grid grid-cols-4 gap-2 p-3 bg-surface-elevated rounded-material text-center"><div><div class="text-sm font-medium text-text-light tabular-nums">$0.000202</div><div class="text-xs text-text-muted">cost</div></div></div></div><div class="mb-4"><div class="text-sm font-medium text-text-light mb-3 flex items-center gap-2"><span>ğŸ“Š</span><span>Sequence</span></div><div class="p-3 bg-surface-code rounded-material border border-white/5 cursor-pointer hover:border-primary/30 transition-colors" onclick="event.stopPropagation(); showDiagram(this.dataset.mermaidCode);" data-mermaid-code="sequenceDiagram
    participant User
    participant Agent
    participant Tools

    User-&gt;&gt;Agent: &#34;I have money in checking and savings. How should I allocate my funds?&#34;
    Agent-&gt;&gt;User: &#34;To provide you with a recommendation on how to allocate your funds between check&#34;"><div class="mermaid text-xs">sequenceDiagram
    participant User
    participant Agent
    participant Tools

    User->>Agent: "I have money in checking and savings. How should I allocate my funds?"
    Agent->>User: "To provide you with a recommendation on how to allocate your funds between check"</div></div></div><div class="mb-4"><div class="text-sm font-medium text-text-light mb-3 flex items-center gap-2"><span>ğŸ’¬</span><span>Response</span></div><div style="padding: 1rem; background-color: var(--color-surface-elevated); border-radius: 0.5rem; color: var(--color-text); white-space: pre-wrap; word-wrap: break-word; line-height: 1.625;">To provide you with a recommendation on how to allocate your funds between checking and savings, could you please share your current balances in each account? If you want, I can retrieve your current balances for you.</div></div><div><div class="text-sm font-medium text-red-400 mb-3 flex items-center gap-2"><span>âŒ</span><span>Error</span></div><div style="padding: 0.75rem; background-color: rgb(127, 29, 29); border: 1px solid rgb(153, 27, 27); border-radius: 0.5rem; color: rgb(254, 202, 202); font-size: 0.875rem; white-space: pre-wrap; word-wrap: break-word; max-height: 200px; overflow-y: auto;">      AssertionError: assert (False or False)
       +  where False = tool_was_called(&#39;get_all_balances&#39;)
       +    where tool_was_called = AgentResult(SUCCESS)\n  Turns: 2\n  Tools called: none\n  Duration: 1180ms\n  Tokens: 377 | Cost: $0.000202\n  Final: &#39;To provide you with a recommendation on how to allocate your funds between checking and savings, cou&#39;....tool_was_called
       +  and   False = tool_was_called(&#39;get_balance&#39;)
       +    where tool_was_called = AgentResult(SUCCESS)\n  Tur

... (error truncated, see full logs for details)</div></div></div></div></div></div></div></div></div><style>
.test-group.collapsed .group-content {
    display: none;
}
.test-group.collapsed .expand-icon {
    transform: rotate(-90deg);
}
.test-row.hidden {
    display: none;
}
.test-detail.hidden {
    display: none;
}
</style></section></div><div id="overlay" class="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 hidden items-center justify-center p-8" onclick="hideOverlay()"><button class="absolute top-4 right-4 w-10 h-10 flex items-center justify-center text-2xl text-text-muted hover:text-text-light bg-surface-card rounded-full border border-white/10 transition-colors" onclick="hideOverlay()">âœ•</button><div class="w-[90vw] h-[85vh] overflow-auto bg-surface-card rounded-lg p-6 shadow-material-lg flex items-center justify-center" onclick="event.stopPropagation()"><div class="mermaid w-full h-full" id="overlay-mermaid"></div></div></div><div id="diagram-hover-popup" class="fixed z-40 bg-surface-card rounded-lg shadow-material-lg border border-white/10 p-4 hidden max-w-xl" onmouseenter="keepDiagramHover()" onmouseleave="hideDiagramHover()" onclick="hideOverlay(); this.classList.add(&#39;hidden&#39;); showDiagram(document.getElementById(&#39;hover-mermaid&#39;).innerHTML);"><div class="mermaid" id="hover-mermaid"></div></div><style>
#overlay.active { display: flex !important; }
#diagram-hover-popup.active { display: block !important; }

/* Scale the mermaid SVG in overlay to fill available space */
#overlay-mermaid svg {
    max-width: 100%;
    max-height: 100%;
    width: auto;
    height: auto;
    min-height: 60vh;
}
</style><script>
// pytest-aitest Report Scripts

// Initialize Mermaid with dark theme
mermaid.initialize({ 
    startOnLoad: true,
    theme: 'dark',
    securityLevel: 'loose',
    themeVariables: {
        primaryColor: '#4051b5',
        primaryTextColor: '#c9d1d9',
        primaryBorderColor: '#4051b5',
        lineColor: '#8b949e',
        secondaryColor: '#282c34',
        tertiaryColor: '#1e2129',
        background: '#282c34',
        mainBkg: '#282c34',
        noteBkgColor: '#2d333b',
        noteTextColor: '#c9d1d9',
        actorTextColor: '#c9d1d9',
        actorBkg: '#2d323c',
        actorBorder: '#4051b5',
        signalColor: '#c9d1d9',
        signalTextColor: '#c9d1d9',
    }
});

// Copy to clipboard for suggestions
function copyToClipboard(button, text) {
    navigator.clipboard.writeText(text).then(() => {
        const originalText = button.textContent;
        button.textContent = 'âœ“ Copied!';
        button.classList.add('copied');
        setTimeout(() => {
            button.textContent = originalText;
            button.classList.remove('copied');
        }, 2000);
    }).catch(err => {
        console.error('Failed to copy:', err);
        button.textContent = 'âŒ Error';
        setTimeout(() => {
            button.textContent = 'ğŸ“‹ Copy';
        }, 2000);
    });
}

// Fullscreen diagram viewer
function showDiagram(mermaidCode) {
    const overlay = document.getElementById('overlay');
    const content = document.getElementById('overlay-mermaid');
    
    // Set the raw mermaid code as text content (not innerHTML to avoid escaping issues)
    content.textContent = mermaidCode;
    
    // Remove any previous rendering attributes
    content.removeAttribute('data-processed');
    
    overlay.classList.add('active');
    
    // Run mermaid on this element
    mermaid.run({ nodes: [content] }).catch(err => {
        console.error('Mermaid render error:', err);
        // Show the raw code if rendering fails
        content.textContent = 'Error rendering diagram:\n' + mermaidCode;
    });
}

function hideOverlay() {
    document.getElementById('overlay').classList.remove('active');
}

// Close overlay on Escape key
document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') hideOverlay();
});

// Hover popup for side-by-side diagrams
let hoverTimeout = null;
function showDiagramHover(element, mermaidCode) {
    clearTimeout(hoverTimeout);
    const popup = document.getElementById('diagram-hover-popup');
    const content = document.getElementById('hover-mermaid');
    content.innerHTML = mermaidCode;
    popup.classList.add('active');
    mermaid.run({ nodes: [content] });
}

function hideDiagramHover() {
    hoverTimeout = setTimeout(() => {
        document.getElementById('diagram-hover-popup').classList.remove('active');
    }, 100);
}

function keepDiagramHover() {
    clearTimeout(hoverTimeout);
}

// Side-by-side test selector
function showSideBySideTest(testId) {
    // Hide all groups
    document.querySelectorAll('.side-by-side-group').forEach(group => {
        group.classList.remove('active');
    });
    // Show selected group
    const selected = document.getElementById(testId);
    if (selected) {
        selected.classList.add('active');
        // Re-render mermaid diagrams in the newly visible group
        mermaid.run({ nodes: selected.querySelectorAll('.mermaid') });
    }
}


// All agent data for client-side filtering
const allAgents = [{"id": "be927112-ef05-4e33-9522-fc0e896802ae", "name": "gpt-5-mini", "pass_rate": 100.0}, {"id": "14c561dd-18dd-4730-a19e-13053d8b33f7", "name": "gpt-5-mini + financial-advisor", "pass_rate": 100.0}, {"id": "e32f86b7-b835-4ea4-8e57-d83719f1e9d9", "name": "gpt-4.1-mini", "pass_rate": 50.0}];
const allAgentsById = {"be927112-ef05-4e33-9522-fc0e896802ae": {"id": "be927112-ef05-4e33-9522-fc0e896802ae", "name": "gpt-5-mini"}, "14c561dd-18dd-4730-a19e-13053d8b33f7": {"id": "14c561dd-18dd-4730-a19e-13053d8b33f7", "name": "gpt-5-mini + financial-advisor"}, "e32f86b7-b835-4ea4-8e57-d83719f1e9d9": {"id": "e32f86b7-b835-4ea4-8e57-d83719f1e9d9", "name": "gpt-4.1-mini"}};

// Track selected agents (exactly 2)
let selectedAgentIds = ["be927112-ef05-4e33-9522-fc0e896802ae", "14c561dd-18dd-4730-a19e-13053d8b33f7"];

// Agent comparison logic - always keep exactly 2 selected
function updateAgentComparison(clickedAgentId) {
    const checkboxes = document.querySelectorAll('input[name="compare-agent"]');
    
    // If clicking an already-selected agent, do nothing (keep 2 selected)
    if (selectedAgentIds.includes(clickedAgentId)) {
        // Re-check it to prevent unchecking
        checkboxes.forEach(cb => {
            if (cb.value === clickedAgentId) {
                cb.checked = true;
            }
        });
        return;
    }
    
    // Replace the oldest selection with the new one
    selectedAgentIds.shift();  // Remove first (oldest)
    selectedAgentIds.push(clickedAgentId);  // Add new one
    
    // Update all checkboxes to match selectedAgentIds
    checkboxes.forEach(cb => {
        cb.checked = selectedAgentIds.includes(cb.value);
        cb.closest('.agent-chip').classList.toggle('selected', cb.checked);
    });
    
    // Update visible columns in test comparison
    document.querySelectorAll('.comparison-column').forEach(col => {
        const agentId = col.dataset.agentId;
        if (agentId) {
            const shouldShow = selectedAgentIds.includes(agentId);
            col.classList.toggle('hidden', !shouldShow);
            
            // Render mermaid diagrams in newly visible columns
            if (shouldShow) {
                const diagrams = col.querySelectorAll('.mermaid:not([data-processed])');
                if (diagrams.length > 0) {
                    mermaid.run({ nodes: diagrams });
                }
            }
        }
    });
    
    // Update comparison grid layout based on visible columns
    document.querySelectorAll('.comparison-grid').forEach(grid => {
        const visibleCols = grid.querySelectorAll('.comparison-column:not(.hidden)').length;
        grid.style.gridTemplateColumns = `repeat(${visibleCols}, 1fr)`;
    });
    
    // Update agent cards visibility
    document.querySelectorAll('.agent-card[data-card-id]').forEach(card => {
        const agentId = card.dataset.cardId;
        card.classList.toggle('hidden', !selectedAgentIds.includes(agentId));
    });
    
    // Update comparison row agent results
    document.querySelectorAll('.agent-result-item').forEach(item => {
        const agentId = item.dataset.agentId;
        item.classList.toggle('hidden', !selectedAgentIds.includes(agentId));
    });
    
    console.log('Selected agents:', selectedAgentIds);
}

// Test filtering
function filterTests(filter) {
    document.querySelectorAll('.filter-btn').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.filter === filter);
    });
    
    let visibleCount = 0;
    document.querySelectorAll('.test-row').forEach(row => {
        let show = true;
        if (filter === 'diff') {
            show = row.dataset.hasDiff === 'true';
        } else if (filter === 'failed') {
            show = row.dataset.hasFailed === 'true';
        }
        row.classList.toggle('hidden', !show);
        if (show) visibleCount++;
    });
    
    document.getElementById('visible-count').textContent = visibleCount;
}

// Group toggle
function toggleGroup(group) {
    group.classList.toggle('collapsed');
}

// Test detail toggle - also renders mermaid diagrams when expanded
function toggleTestDetail(row) {
    const detail = row.querySelector('.test-detail');
    const wasHidden = detail.classList.contains('hidden');
    detail.classList.toggle('hidden');
    
    // If we're showing the detail, render any mermaid diagrams
    if (wasHidden) {
        const diagrams = detail.querySelectorAll('.mermaid:not([data-processed])');
        if (diagrams.length > 0) {
            mermaid.run({ nodes: diagrams });
        }
    }
}

// Initialize on page load - process visible mermaid diagrams
document.addEventListener('DOMContentLoaded', () => {
    // Mermaid should auto-process with startOnLoad, but just in case
    const visibleDiagrams = document.querySelectorAll('.mermaid:not(.hidden .mermaid)');
    if (visibleDiagrams.length > 0) {
        mermaid.run({ nodes: visibleDiagrams });
    }
});
</script></body></html>